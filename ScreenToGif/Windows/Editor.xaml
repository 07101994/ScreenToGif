<Window xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:componentModel="clr-namespace:System.ComponentModel;assembly=WindowsBase"
        xmlns:n="clr-namespace:ScreenToGif.Controls"
        xmlns:local="clr-namespace:ScreenToGif.Windows"
        x:Class="ScreenToGif.Windows.Editor"
        xmlns:util="clr-namespace:ScreenToGif.Util"
        xmlns:prop="clr-namespace:ScreenToGif.Properties"
        xmlns:converters="clr-namespace:ScreenToGif.Util.Converters"
        x:Name="EditorWindow" Title="Editor" MinHeight="500" MinWidth="700" Background="#FFF1F1F1"
        Left="{Binding Source={x:Static prop:Settings.Default}, Path=EditorLeft, Mode=TwoWay, Converter={StaticResource DoubleToPositionSizeConverter}, ConverterParameter=Left}"
        Top="{Binding Source={x:Static prop:Settings.Default}, Path=EditorTop, Mode=TwoWay, Converter={StaticResource DoubleToPositionSizeConverter}, ConverterParameter=Top}"
        Height="{Binding Source={x:Static prop:Settings.Default}, Path=EditorHeight, Mode=TwoWay, Converter={StaticResource DoubleToPositionSizeConverter}, ConverterParameter=Height}"
        Width="{Binding Source={x:Static prop:Settings.Default}, Path=EditorWidth, Mode=TwoWay, Converter={StaticResource DoubleToPositionSizeConverter}, ConverterParameter=Width}"
        Icon="/Resources/Logo.ico" Loaded="Window_Loaded" UseLayoutRounding="True" Closing="EditorWindow_Closing" 
        FocusManager.FocusedElement="{Binding RelativeSource={x:Static RelativeSource.Self}, Mode=OneTime}">

    <Window.Resources>
        <converters:DoubleToInt x:Key="DoubleToIntConverter"/>
        <converters:InvertedBoolToVisibility x:Key="InvertedBoolToVisibilityConverter"/>
        <converters:IntToRect x:Key="IntToRectConverter"/>
        <converters:MaximumValue x:Key="MaximumValueConverter"/>
        <converters:DoubleTimesAHundredToInt x:Key="DoubleTimesAHundredToIntConverter"/>
        <converters:UriToBitmap x:Key="UriToBitmapConverter"/>
        <converters:PathToFilename x:Key="PathToFilenameConverter"/>
        <converters:DoubleToThickness x:Key="DoubleToThicknessConverter"/>
        <converters:SelectionToEditingMode x:Key="SelectionToEditingModeConverter"/>
        <converters:SelectionToDrawingAttributes x:Key="SelectionToDrawingAttributesConverter"/>
        <converters:SelectionToStylusShape x:Key="SelectionToStylusShapeConverter"/>
        <converters:StylusTipToBool x:Key="StylusTipToBoolConverter"/>

        <Storyboard x:Key="ShowPanelStoryboard">
            <BooleanAnimationUsingKeyFrames Storyboard.TargetName="ActionGrid" Storyboard.TargetProperty="IsHitTestVisible" Duration="0:0:0" >
                <DiscreteBooleanKeyFrame Value="True" KeyTime="0:0:0"/>
            </BooleanAnimationUsingKeyFrames>

            <DoubleAnimation Storyboard.TargetName="ActionGrid" Storyboard.TargetProperty="(Grid.MinWidth)" From="0" To="220" Duration="0:0:1">
                <DoubleAnimation.EasingFunction>
                    <PowerEase Power="8" />
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
            <DoubleAnimation Storyboard.TargetName="ActionGrid" Storyboard.TargetProperty="(Grid.Width)" From="0" To="220" Duration="0:0:1">
                <DoubleAnimation.EasingFunction>
                    <PowerEase Power="8" />
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
            <DoubleAnimation Storyboard.TargetName="ActionGrid" Storyboard.TargetProperty="(Grid.Opacity)" From="0" To="1" Duration="0:0:1">
                <DoubleAnimation.EasingFunction>
                    <PowerEase Power="8" />
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>

        <Storyboard x:Key="HidePanelStoryboard">
            <BooleanAnimationUsingKeyFrames Storyboard.TargetName="ActionGrid" Storyboard.TargetProperty="IsHitTestVisible" Duration="0:0:0" >
                <DiscreteBooleanKeyFrame Value="False" KeyTime="0:0:0"/>
            </BooleanAnimationUsingKeyFrames>

            <DoubleAnimation Storyboard.TargetName="ActionGrid" Storyboard.TargetProperty="(Grid.MinWidth)" From="{Binding ElementName=ActionGrid,Path=ActualWidth}" To="0" Duration="0:0:1">
                <DoubleAnimation.EasingFunction>
                    <PowerEase Power="8" />
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
            <DoubleAnimation Storyboard.TargetName="ActionGrid" Storyboard.TargetProperty="(Grid.Width)" From="{Binding ElementName=ActionGrid,Path=ActualWidth}" To="0" Duration="0:0:1">
                <DoubleAnimation.EasingFunction>
                    <PowerEase Power="8"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
            <DoubleAnimation Storyboard.TargetName="ActionGrid" Storyboard.TargetProperty="(Grid.Opacity)" From="{Binding ElementName=ActionGrid,Path=Opacity}" To="0" Duration="0:0:1">
                <DoubleAnimation.EasingFunction>
                    <PowerEase Power="8" />
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>

        <Storyboard x:Key="HideWelcomeBorderStoryboard">
            <DoubleAnimation Storyboard.TargetName="WelcomeGrid" Storyboard.TargetProperty="(Grid.Opacity)" From="{Binding ElementName=WelcomeGrid,Path=Opacity}" To="0" Duration="0:0:1">
                <DoubleAnimation.EasingFunction>
                    <PowerEase Power="8" />
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>

            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="WelcomeGrid" Storyboard.TargetProperty="Visibility" Duration="0:0:1" >
                <DiscreteObjectKeyFrame Value="{x:Static Visibility.Collapsed}" KeyTime="0:0:1"/>
            </ObjectAnimationUsingKeyFrames>
        </Storyboard>

        <Storyboard x:Key="ShowWelcomeBorderStoryboard">
            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="WelcomeGrid" Storyboard.TargetProperty="Visibility" Duration="0:0:0" >
                <DiscreteObjectKeyFrame Value="{x:Static Visibility.Visible}" KeyTime="0:0:0"/>
            </ObjectAnimationUsingKeyFrames>

            <DoubleAnimation Storyboard.TargetName="WelcomeGrid" Storyboard.TargetProperty="(Grid.Opacity)" From="0" To="1" Duration="0:0:1">
                <DoubleAnimation.EasingFunction>
                    <PowerEase Power="8" />
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>

        <Storyboard x:Key="HideOverlayGridStoryboard">
            <DoubleAnimation Storyboard.TargetName="OverlayGrid" Storyboard.TargetProperty="(Grid.Opacity)" From="{Binding ElementName=OverlayGrid,Path=Opacity}" To="0" Duration="0:0:1">
                <DoubleAnimation.EasingFunction>
                    <PowerEase Power="8" />
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>

            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="OverlayGrid" Storyboard.TargetProperty="Visibility" Duration="0:0:1" >
                <DiscreteObjectKeyFrame Value="{x:Static Visibility.Collapsed}" KeyTime="0:0:1"/>
            </ObjectAnimationUsingKeyFrames>
        </Storyboard>

        <Storyboard x:Key="ShowOverlayGridStoryboard">
            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="OverlayGrid" Storyboard.TargetProperty="Visibility" Duration="0:0:0" >
                <DiscreteObjectKeyFrame Value="{x:Static Visibility.Visible}" KeyTime="0:0:0"/>
            </ObjectAnimationUsingKeyFrames>

            <DoubleAnimation Storyboard.TargetName="OverlayGrid" Storyboard.TargetProperty="(Grid.Opacity)" From="0" To="1" Duration="0:0:1">
                <DoubleAnimation.EasingFunction>
                    <PowerEase Power="8" />
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>


        <CollectionViewSource x:Key="MyFonts" Source="{Binding Source={x:Static Fonts.SystemFontFamilies}}">
            <CollectionViewSource.SortDescriptions>
                <componentModel:SortDescription PropertyName="Source" />
            </CollectionViewSource.SortDescriptions>
        </CollectionViewSource>

        <Style x:Key="FontStyle">
            <Setter Property="Control.FontFamily" Value="{Binding .}" />
            <Setter Property="Control.FontSize" Value="16" />
        </Style>

        <DataTemplate x:Key="FontTemplate">
            <VirtualizingStackPanel IsVirtualizing="True" VirtualizationMode="Recycling" ScrollViewer.IsDeferredScrollingEnabled="True">
                <TextBlock Style="{StaticResource FontStyle}" Text="{Binding .}" ToolTip="{Binding .}" />
            </VirtualizingStackPanel>
        </DataTemplate>
    </Window.Resources>

    <Window.CommandBindings>
        <CommandBinding Command="util:Commands.NewRecording" CanExecute="NewRecording_CanExecute" Executed="NewRecording_Executed"/>
        <CommandBinding Command="util:Commands.NewWebcamRecording" CanExecute="NewRecording_CanExecute" Executed="NewWebcamRecording_Executed"/>
        <CommandBinding Command="util:Commands.NewAnimation" CanExecute="NewRecording_CanExecute" Executed="NewAnimation_Executed"/>
        <CommandBinding Command="util:Commands.NewFromMediaProject" CanExecute="NewRecording_CanExecute" Executed="NewFromMediaProject_Executed"/>

        <CommandBinding Command="util:Commands.InsertRecording" CanExecute="Insert_CanExecute" Executed="InsertRecording_Executed"/>
        <CommandBinding Command="util:Commands.InsertWebcamRecording" CanExecute="Insert_CanExecute" Executed="InsertWebcamRecording_Executed"/>
        <CommandBinding Command="util:Commands.InsertFromMedia" CanExecute="Insert_CanExecute" Executed="InsertFromMedia_Executed"/>

        <CommandBinding Command="util:Commands.SaveAsGif" CanExecute="File_CanExecute" Executed="SaveAsGif_Executed"/>
        <CommandBinding Command="util:Commands.SaveAsVideo" CanExecute="File_CanExecute" Executed="SaveAsVideo_Executed"/>
        <CommandBinding Command="util:Commands.SaveAsProject" CanExecute="File_CanExecute" Executed="SaveAsProject_Executed"/>
        <CommandBinding Command="util:Commands.DiscardProject" CanExecute="File_CanExecute" Executed="DiscardProject_Executed"/>

        <CommandBinding Command="util:Commands.FirstFrame" CanExecute="Playback_CanExecute" Executed="FirstFrame_Executed"/>
        <CommandBinding Command="util:Commands.PreviousFrame" CanExecute="Playback_CanExecute" Executed="PreviousFrame_Executed"/>
        <CommandBinding Command="util:Commands.Play" CanExecute="Playback_CanExecute" Executed="Play_Executed"/>
        <CommandBinding Command="util:Commands.NextFrame" CanExecute="Playback_CanExecute" Executed="NextFrame_Executed"/>
        <CommandBinding Command="util:Commands.LastFrame" CanExecute="Playback_CanExecute" Executed="LastFrame_Executed"/>

        <CommandBinding Command="util:Commands.Zoom100" CanExecute="Zoom_CanExecute" Executed="Zoom100_Executed"/>
        <CommandBinding Command="util:Commands.FitImage" CanExecute="Zoom_CanExecute" Executed="FitImage_Executed"/>

        <CommandBinding Command="Undo" CanExecute="Undo_CanExecute" Executed="Undo_Executed"/>
        <CommandBinding Command="util:Commands.Reset" CanExecute="Reset_CanExecute" Executed="Reset_Executed"/>
        <CommandBinding Command="Redo" CanExecute="Redo_CanExecute" Executed="Redo_Executed"/>

        <CommandBinding Command="Cut" CanExecute="ClipBoard_CanExecute" Executed="Cut_Executed"/>
        <CommandBinding Command="Copy" CanExecute="ClipBoard_CanExecute" Executed="Copy_Executed"/>
        <CommandBinding Command="Paste" CanExecute="ClipBoard_CanExecute" Executed="Paste_Executed"/>

        <CommandBinding Command="Delete" CanExecute="Delete_CanExecute" Executed="Delete_Executed"/>
        <CommandBinding Command="DeletePreviousWord" CanExecute="DeletePrevious_CanExecute" Executed="DeletePrevious_Executed"/>
        <CommandBinding Command="DeleteNextWord" CanExecute="DeleteNext_CanExecute" Executed="DeleteNext_Executed"/>

        <CommandBinding Command="util:Commands.Reverse" CanExecute="Reverse_CanExecute" Executed="Reverse_Executed"/>
        <CommandBinding Command="util:Commands.Yoyo" CanExecute="Yoyo_CanExecute" Executed="Yoyo_Executed"/>
        <CommandBinding Command="util:Commands.MoveLeft" CanExecute="MoveLeftRight_CanExecute" Executed="MoveLeft_Executed"/>
        <CommandBinding Command="util:Commands.MoveRight" CanExecute="MoveLeftRight_CanExecute" Executed="MoveRight_Executed"/>

        <CommandBinding Command="util:Commands.Resize" CanExecute="Image_CanExecute" Executed="Resize_Executed"/>
        <CommandBinding Command="util:Commands.Crop" CanExecute="Image_CanExecute" Executed="Crop_Executed"/>
        <CommandBinding Command="util:Commands.FlipRotate" CanExecute="Image_CanExecute" Executed="FlipRotate_Executed"/>

        <CommandBinding Command="util:Commands.Caption" CanExecute="Image_CanExecute" Executed="Caption_Executed"/>
        <CommandBinding Command="util:Commands.FreeText" CanExecute="Image_CanExecute" Executed="FreeText_Executed"/>
        <CommandBinding Command="util:Commands.TitleFrame" CanExecute="Image_CanExecute" Executed="TitleFrame_Executed"/>

        <CommandBinding Command="util:Commands.FreeDrawing" CanExecute="Image_CanExecute" Executed="FreeDrawing_Executed"/>
        <CommandBinding Command="util:Commands.Watermark" CanExecute="Image_CanExecute" Executed="Watermark_Executed"/>
        <CommandBinding Command="util:Commands.Border" CanExecute="Image_CanExecute" Executed="Border_Executed"/>
        <CommandBinding Command="util:Commands.Cinemagraph" CanExecute="Image_CanExecute" Executed="Cinemagraph_Executed"/>
        
        <CommandBinding Command="util:Commands.SelectAll" CanExecute="Selection_CanExecute" Executed="SelectAll_Executed"/>
        <CommandBinding Command="util:Commands.InverseSelection" CanExecute="Selection_CanExecute" Executed="InverseSelection_Executed"/>
        <CommandBinding Command="util:Commands.Unselect" CanExecute="Image_CanExecute" Executed="DeselectAll_Executed"/>
        
        <CommandBinding Command="util:Commands.OverrideDelay" CanExecute="Image_CanExecute" Executed="OverrideDelay_Executed"/>
        <CommandBinding Command="util:Commands.ChangeDelay" CanExecute="Image_CanExecute" Executed="ChangeDelay_Executed"/>
    </Window.CommandBindings>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="1*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <n:HideableTabControl x:Name="RibbonTabControl" Margin="0,5,0,0" Effect="{StaticResource Shadow.Border.Tiny}" FontSize="13" IsTabStop="False">
            <TabItem Header="File" IsSelected="True">
                <Grid Height="94" Margin="2" Background="#FFFAFAFA" Effect="{StaticResource Shadow.Invariant}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition/>
                    </Grid.ColumnDefinitions>

                    <Grid Grid.Column="0" Margin="0,1,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <Label Grid.Column="0" Grid.ColumnSpan="4" Grid.Row="1" Content="New" 
							HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Padding="0" 
							FontSize="12" Foreground="#FF707070"/>

                        <n:ImageButton Grid.Column="0" Grid.Row="0" x:Name="NewRecordingButton" Text="Recording" Content="{StaticResource Vector.Record.New}" 
							Margin="0"  MinWidth="60" MaxWidth="65" MaxSize="30" VerticalContentAlignment="Top"
							Command="util:Commands.NewRecording" Style="{StaticResource Style.Button.Vertical}"/>
                        <n:ImageButton Grid.Column="1" Grid.Row="0" x:Name="NewWebcamRecordingButton" Text="Webcam Recording" Content="{StaticResource Vector.Camera.New}" 
							Margin="0" MinWidth="60" MaxWidth="65" MaxSize="30" VerticalContentAlignment="Top"
							Command="util:Commands.NewWebcamRecording" Style="{StaticResource Style.Button.Vertical}"/>
                        <n:ImageButton Grid.Column="2" Grid.Row="0" x:Name="NewAnimationButton" Text="Blank Animation" Content="{StaticResource Vector.File.New}" 
							Margin="0" MinWidth="60" MaxWidth="65" MaxSize="30" VerticalContentAlignment="Top"
							Command="util:Commands.NewAnimation" Style="{StaticResource Style.Button.Vertical}" />
                        <n:ImageButton Grid.Column="3" Grid.Row="0" x:Name="OpenMediaProjectButton" Text="Media or Project" Content="{StaticResource Vector.Folder}" 
							Margin="0" MinWidth="60" MaxWidth="65" MaxSize="30" VerticalContentAlignment="Top"
							Command="util:Commands.NewFromMediaProject" Style="{StaticResource Style.Button.Vertical}"/>
                    </Grid>

                    <Separator Grid.Column="1" Grid.Row="0" Width="1" Height="Auto" HorizontalAlignment="Left" Margin="3,2"/>

                    <Grid Grid.Column="2" Margin="0,1,0,0"
                          IsEnabled="{Binding FilledList, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:Editor}}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <Label Grid.Column="0" Grid.ColumnSpan="3" Grid.Row="1" Content="Insert" 
							HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Padding="0" 
							FontSize="12" Foreground="#FF707070"/>

                        <n:ImageButton Grid.Column="0" Grid.Row="0" x:Name="InsertRecordingButton" Text="Recording" Content="{StaticResource Vector.Record.Add}" 
							Margin="0" MaxWidth="65"  MaxSize="30" VerticalContentAlignment="Top"
							Command="util:Commands.InsertRecording" Style="{StaticResource Style.Button.Vertical}"/>

                        <n:ImageButton Grid.Column="1" Grid.Row="0" x:Name="InsertWebcamRecordingButton" Text="Webcam Recording" Content="{StaticResource Vector.Camera.Add}" 
							Margin="0" MaxWidth="65" MaxSize="30" VerticalContentAlignment="Top"
							Command="util:Commands.InsertWebcamRecording" Style="{StaticResource Style.Button.Vertical}"/>

                        <n:ImageButton Grid.Column="2" Grid.Row="0" x:Name="InsertImageButton" Text="Media"  Content="{StaticResource Vector.Folder}" 
							Margin="0" MinWidth="47" MaxSize="30" VerticalContentAlignment="Top" 
							Command="util:Commands.InsertFromMedia" Style="{StaticResource Style.Button.Vertical}"/>
                    </Grid>

                    <Separator Grid.Column="3" Grid.Row="0" Width="1" Height="Auto" HorizontalAlignment="Left" Margin="3,2"/>

                    <Grid Grid.Column="4" Margin="0,1,0,0"
                          IsEnabled="{Binding FilledList, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:Editor}}}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <Label Grid.Column="0" Grid.ColumnSpan="4" Grid.Row="1" Content="File" 
							HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Padding="0" 
							FontSize="12" Foreground="#FF707070"/>

                        <n:ImageButton Grid.Column="0" Grid.Row="0" x:Name="SaveButton" Text="Save As Gif" Content="{StaticResource Vector.Gif}" 
							Margin="0" Padding="3,3,3,0" MinWidth="60" MaxWidth="65" MaxSize="30" VerticalContentAlignment="Top"
							Command="util:Commands.SaveAsGif" Style="{StaticResource Style.Button.Vertical}"/>
                        <n:ImageButton Grid.Column="1" Grid.Row="0" x:Name="SaveVideoButton" Text="Save As Video" Content="{StaticResource Vector.Video}" 
							Margin="0" Padding="3,3,3,0" MinWidth="60" MaxWidth="65" MaxSize="30" VerticalContentAlignment="Top"
							Command="util:Commands.SaveAsVideo" Style="{StaticResource Style.Button.Vertical}"/>
                        <n:ImageButton Grid.Column="2" Grid.Row="0" x:Name="SaveProjectButton" Text="Save Project" Content="{StaticResource Vector.Save.Project}" 
							Margin="0" Padding="3,3,3,0" MinWidth="60" MaxWidth="65" MaxSize="30" VerticalContentAlignment="Top"
							Command="util:Commands.SaveAsProject" Style="{StaticResource Style.Button.Vertical}"/>
                        <n:ImageButton Grid.Column="3" Grid.Row="0" x:Name="DiscardProjectButton" Text="Discard Project" Content="{StaticResource Vector.Remove}" 
							Margin="0" Padding="3,3,3,0" MinWidth="60" MaxWidth="65" MaxSize="30" VerticalContentAlignment="Top"
							Command="util:Commands.DiscardProject" Style="{StaticResource Style.Button.Vertical}"/>
                    </Grid>

                    <Separator Grid.Column="5" Grid.Row="0" Width="1" Height="Auto" HorizontalAlignment="Left" Margin="3,2"/>
                </Grid>
            </TabItem>
            <TabItem Header="View">
                <Grid Height="94" Margin="2" Background="#FFFAFAFA" Effect="{StaticResource Shadow.Invariant}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition/>
                    </Grid.ColumnDefinitions>

                    <Grid Grid.Column="0" Margin="0,1,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <Label Grid.Column="0" Grid.ColumnSpan="3" Grid.Row="1" Content="Playback" 
							HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Padding="0" 
							FontSize="12" Foreground="#FF707070"/>

                        <n:ImageRepeatButton Grid.Column="0" Grid.Row="0" x:Name="PreviousButton" Text="Previous" Content="{StaticResource Vector.Backward.Bold}" 
							Margin="0" MinWidth="60" MaxWidth="65" MaxSize="30" VerticalContentAlignment="Top"
							Command="util:Commands.PreviousFrame" Style="{StaticResource Style.RepeatButton.Vertical}" />
                        <n:ImageButton Grid.Column="1" Grid.Row="0" x:Name="PlayButton" Text="Play" Content="{StaticResource Vector.Play}" 
							Margin="0" MinWidth="60" MaxWidth="65" MaxSize="30" VerticalContentAlignment="Top"
							Command="util:Commands.Play" Style="{StaticResource Style.Button.Vertical}"/>
                        <n:ImageRepeatButton Grid.Column="2" Grid.Row="0" x:Name="NextButton" Text="Next" Content="{StaticResource Vector.Forward.Bold}" 
							Margin="0" MinWidth="60" MaxWidth="65" MaxSize="30" VerticalContentAlignment="Top"
							Command="util:Commands.NextFrame" Style="{StaticResource Style.RepeatButton.Vertical}"/>
                    </Grid>

                    <Separator Grid.Column="1" Grid.Row="0" Width="1" Height="Auto" HorizontalAlignment="Left" Margin="3,2"/>

                    <Grid Grid.Column="2" Margin="0,1,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <Label Grid.Column="0" Grid.ColumnSpan="3" Grid.Row="1" Content="Zoom" 
							HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Padding="0" 
							FontSize="12" Foreground="#FF707070"/>

                        <n:ImageButton Grid.Column="0" Grid.Row="0" x:Name="Zoom100Button" Text="100%" Content="{StaticResource Vector.Fit}" 
							Margin="0" Padding="3,3,3,0" MinWidth="60" MaxWidth="65" MaxSize="30" VerticalContentAlignment="Top"
							Style="{StaticResource Style.Button.Vertical}" Command="util:Commands.Zoom100" />

                        <Grid Grid.Column="1" Grid.Row="0">
                            <Grid.RowDefinitions>
                                <RowDefinition/>
                                <RowDefinition/>
                                <!--<RowDefinition/>-->
                            </Grid.RowDefinitions>

                            <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,5" IsEnabled="{Binding ElementName=Zoom100Button, Path=IsEnabled}">
                                <Viewbox Child="{StaticResource Vector.Zoom}" MaxWidth="35" MaxHeight="35" Style="{StaticResource ViewBoxStyle}"/>
                                <n:NumericUpDown x:Name="ZoomNumericUpDown"
                                    Value="{Binding Zoom, Converter={StaticResource IntToDecimalConverter}, ElementName=ZoomBoxControl, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                    Minimum="5" Maximum="500" Margin="5,0,0,0" MinWidth="60"/>
                                <Label Content="%" VerticalContentAlignment="Center" Padding="5,0"/>
                            </StackPanel>

                            <n:ImageButton Grid.Column="0" Grid.Row="1" x:Name="FitButton" Text="Fit Image" Content="{StaticResource Vector.PictureFit}" 
							Margin="0" Padding="2" MinWidth="60" MaxSize="35" VerticalContentAlignment="Center"
							Style="{StaticResource Style.Button.Horizontal}" Command="util:Commands.FitImage" />

                        </Grid>
                    </Grid>

                    <Separator Grid.Column="3" Grid.Row="0" Width="1" Height="Auto" HorizontalAlignment="Left" Margin="3,2"/>

                    <Grid Grid.Column="4" Margin="0,1,0,0" Visibility="Collapsed">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <Label Grid.Column="0" Grid.ColumnSpan="1" Grid.Row="1" Content="Windows" 
							HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Padding="0" 
							FontSize="12" Foreground="#FF707070"/>

                        <n:ImageButton Grid.Column="0" Grid.Row="0" x:Name="ShowEncoderButton" Text="Show Encoder" Content="{StaticResource Vector.Encoder}" 
							Margin="0" Padding="3,3,3,0" MinWidth="60" MaxWidth="65" MaxSize="30" VerticalContentAlignment="Top"
							Style="{StaticResource Style.Button.Vertical}" Click="ShowEncoderButton_Click" />
                    </Grid>
                </Grid>
            </TabItem>
            <TabItem Header="Edit">
                <Grid Height="94" Margin="2" Background="#FFFAFAFA">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition/>
                    </Grid.ColumnDefinitions>

                    <Grid Grid.Column="0" Margin="0,1,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <Label Grid.Column="0" Grid.Row="1" Grid.ColumnSpan="2" Content="Action Stack" 
						HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Padding="0" 
						FontSize="12" Foreground="#FF707070"/>

                        <n:ImageButton x:Name="UndoButton" Grid.Row="0" Grid.Column="0" Text="Undo" Content="{StaticResource Vector.Undo}"
						               Margin="0" Padding="3,3,3,0" MinWidth="60" MaxWidth="65" MaxSize="30" VerticalContentAlignment="Top"
						               Style="{StaticResource Style.Button.Vertical}" Command="Undo"/>

                        <Grid Grid.Row="0" Grid.Column="1">
                            <Grid.RowDefinitions>
                                <RowDefinition/>
                                <RowDefinition/>
                            </Grid.RowDefinitions>

                            <n:ImageButton x:Name="ResetButton" Grid.Row="0" Text="Reset" Content="{StaticResource Vector.Repeat}"
                                       Margin="0" Padding="2" MinWidth="60" MaxSize="25" VerticalContentAlignment="Center"
						               Style="{StaticResource Style.Button.Horizontal}" Command="util:Commands.Reset"/>

                            <n:ImageButton x:Name="RedoButton" Grid.Row="1" Text="Redo" Content="{StaticResource Vector.Redo}"
                                       Margin="0" Padding="2" MinWidth="60" MaxSize="25" VerticalContentAlignment="Center"
						               Style="{StaticResource Style.Button.Horizontal}" Command="Redo"/>
                        </Grid>
                    </Grid>

                    <Separator Grid.Column="1" Grid.Row="0" Width="1" Height="Auto" HorizontalAlignment="Left" Margin="3,2"/>

                    <Grid Grid.Column="2" Margin="0,1,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <Label Grid.Column="0" Grid.Row="1" Grid.ColumnSpan="2" Content="Clipboard" 
						HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Padding="0" 
						FontSize="12" Foreground="#FF707070"/>

                        <n:ImageButton Grid.Row="1" Grid.Column="1" x:Name="ShowClipboardButton" Content="{StaticResource Vector.Launcher}"
						               Margin="0" MinWidth="10" MaxWidth="65" MaxSize="8" HorizontalAlignment="Right" Padding="5,0"
						               Style="{StaticResource Style.Button.NoText}" Click="ShowClipboardButton_Click"/>

                        <n:ImageButton Grid.Row="0" Grid.Column="0" x:Name="PasteButton" Text="Paste" Content="{StaticResource Vector.Paste}"
						               Margin="0" Padding="3,3,3,0" MinWidth="60" MaxWidth="65" MaxSize="30" VerticalContentAlignment="Top"
						               Style="{StaticResource Style.Button.Vertical}" Command="Paste"/>

                        <Grid Grid.Row="0" Grid.Column="1">
                            <Grid.RowDefinitions>
                                <RowDefinition/>
                                <RowDefinition/>
                            </Grid.RowDefinitions>

                            <n:ImageButton x:Name="CopyButton" Grid.Row="0" Grid.Column="0" Text="Copy" Content="{StaticResource Vector.Copy}"
						                   Margin="0" Padding="2" MinWidth="60" MaxSize="28" VerticalContentAlignment="Center"
						                   Style="{StaticResource Style.Button.Horizontal}" Command="Copy"/>

                            <n:ImageButton x:Name="CutButton" Grid.Row="1" Text="Cut" Content="{StaticResource Vector.Cut}"
						                   Margin="0" Padding="2" MinWidth="60" MaxSize="28" VerticalContentAlignment="Center"
						                   Style="{StaticResource Style.Button.Horizontal}" Command="Cut" />
                        </Grid>
                    </Grid>

                    <Separator Grid.Column="3" Grid.Row="0" Width="1" Height="Auto" HorizontalAlignment="Left" Margin="3,2"/>

                    <Grid Grid.Column="4" Margin="0,1,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <Label Grid.Column="0" Grid.Row="1" Grid.ColumnSpan="2" Content="Frames" 
						HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Padding="0" 
						FontSize="12" Foreground="#FF707070"/>

                        <n:ImageButton Grid.Row="0" Grid.Column="0" x:Name="DeleteButton" Text="Delete" Content="{StaticResource Vector.RemoveImage}"
                                       Margin="0" Padding="3,3,3,0" MinWidth="60" MaxWidth="65" MaxSize="30" VerticalContentAlignment="Top"
						               Style="{StaticResource Style.Button.Vertical}" Command="Delete"/>

                        <Grid Grid.Row="0" Grid.Column="1">
                            <Grid.RowDefinitions>
                                <RowDefinition/>
                                <RowDefinition/>
                            </Grid.RowDefinitions>

                            <n:ImageButton  x:Name="DeleteBeforeButton" Grid.Row="0" Text="Delete Before" Content="{StaticResource Vector.Delete.Before}"
						                Margin="0" Padding="3,3,3,0" MinWidth="60" MaxSize="30" VerticalContentAlignment="Center"
						                Style="{StaticResource Style.Button.Horizontal}" Command="DeletePreviousWord"/>

                            <n:ImageButton x:Name="DeleteAfterButton" Grid.Row="1" Text="Delete After" Content="{StaticResource Vector.Delete.After}"
                                       Margin="0" Padding="3,3,3,0" MinWidth="60" MaxSize="30" VerticalContentAlignment="Center"
						               Style="{StaticResource Style.Button.Horizontal}" Command="DeleteNextWord"/>
                        </Grid>
                    </Grid>

                    <Separator Grid.Column="5" Grid.Row="0" Width="1" Height="Auto" HorizontalAlignment="Left" Margin="3,2"/>

                    <Grid Grid.Column="6" Margin="0,1,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <Label Grid.Column="0" Grid.Row="1" Grid.ColumnSpan="3" Content="Reordering" 
						HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Padding="0" 
						FontSize="12" Foreground="#FF707070"/>

                        <Grid Grid.Row="0" Grid.Column="0">
                            <Grid.RowDefinitions>
                                <RowDefinition/>
                                <RowDefinition/>
                            </Grid.RowDefinitions>

                            <n:ImageButton x:Name="ReverseOrderButton" Grid.Row="0" Text="Reverse" Content="{StaticResource Vector.Invert}"
						                   Margin="0" Padding="3,3,3,0" MaxSize="30" VerticalContentAlignment="Center"
						                   Style="{StaticResource Style.Button.Horizontal}" Command="util:Commands.Reverse" />

                            <n:ImageButton x:Name="YoyoOrderButton" Grid.Row="1" Text="Yoyo" Content="{StaticResource Vector.Yoyo}"
						                   Margin="0" Padding="3,3,3,0" MaxSize="30" VerticalContentAlignment="Center"
						                   Style="{StaticResource Style.Button.Horizontal}" Command="util:Commands.Yoyo" />
                        </Grid>

                        <n:ImageButton  x:Name="MoveLeftButton" Grid.Row="0" Grid.Column="1" Text="Move Left" Content="{StaticResource Vector.MoveLeft}"
						                Margin="0" Padding="1" MinWidth="60" MaxWidth="65" MaxSize="30" VerticalContentAlignment="Top"
						                Style="{StaticResource Style.Button.Vertical}" Command="util:Commands.MoveLeft" />

                        <n:ImageButton  x:Name="MoveRightButton" Grid.Row="0" Grid.Column="2" Text="Move Right" Content="{StaticResource Vector.MoveRight}"
						                Margin="0" Padding="1" MinWidth="60" MaxWidth="65" MaxSize="30" VerticalContentAlignment="Top"
						                Style="{StaticResource Style.Button.Vertical}" Command="util:Commands.MoveRight"/>
                    </Grid>

                    <Separator Grid.Column="7" Grid.Row="0" Width="1" Height="Auto" HorizontalAlignment="Left" Margin="3,2"/>
                </Grid>
            </TabItem>
            <TabItem Header="Image">
                <Grid Height="94" Margin="2" Background="#FFFAFAFA">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition/>
                    </Grid.ColumnDefinitions>

                    <Grid Grid.Column="0" Margin="0,1,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <Label Grid.Column="0" Grid.Row="1" Grid.ColumnSpan="2" x:Name="ResizeLabel" Content="Size and Position" 
						HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Padding="0" 
						FontSize="12" Foreground="#FF707070"/>

                        <n:ImageButton x:Name="ResizeButton" Grid.Row="0" Grid.Column="0" Text="Resize" Content="{StaticResource Vector.Resize}"
						               Margin="0" Padding="2" MinWidth="60" MaxWidth="65" MaxSize="30" VerticalContentAlignment="Top"
						               Style="{StaticResource Style.Button.Vertical}" Command="util:Commands.Resize"/>

                        <Grid Grid.Row="0" Grid.Column="1">
                            <Grid.RowDefinitions>
                                <RowDefinition/>
                                <RowDefinition/>
                            </Grid.RowDefinitions>

                            <n:ImageButton x:Name="CropButton" Grid.Row="0" Text="Crop" Content="{StaticResource Vector.Crop}"
                                       Margin="0" Padding="2" MinWidth="60" MaxSize="25" VerticalContentAlignment="Center"
						               Style="{StaticResource Style.Button.Horizontal}" Command="util:Commands.Crop"/>

                            <n:ImageButton x:Name="FlipRotateButton" Grid.Row="1" Text="Flip/Rotate" Content="{StaticResource Vector.FlipHorizontal}"
                                       Margin="0" Padding="2" MinWidth="60" MaxSize="25" VerticalContentAlignment="Center"
						               Style="{StaticResource Style.Button.Horizontal}" Command="util:Commands.FlipRotate"/>
                        </Grid>
                    </Grid>

                    <Separator Grid.Column="1" Grid.Row="0" Width="1" Height="Auto" HorizontalAlignment="Left" Margin="3,2"/>

                    <Grid Grid.Column="2" Margin="0,1,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <Label Grid.Column="0" Grid.Row="1" Grid.ColumnSpan="2" Content="Text" 
						       HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Padding="0" 
						       FontSize="12" Foreground="#FF707070"/>

                        <n:ImageButton x:Name="CaptionButton" Grid.Row="0" Grid.Column="0" Text="Caption" Content="{StaticResource Vector.Caption}"
						               Margin="0" Padding="2" MinWidth="60" MaxWidth="65" MaxSize="30" VerticalContentAlignment="Top"
						               Command="util:Commands.Caption" Style="{StaticResource Style.Button.Vertical}" />

                        <Grid Grid.Row="0" Grid.Column="1">
                            <Grid.RowDefinitions>
                                <RowDefinition/>
                                <RowDefinition/>
                            </Grid.RowDefinitions>

                            <n:ImageButton x:Name="FreeTextButton" Grid.Row="0" Text="Free Text" Content="{StaticResource Vector.FreeText}"
                                       Margin="0" Padding="2" MinWidth="60" MaxSize="25" VerticalContentAlignment="Center"
						               Command="util:Commands.FreeText" Style="{StaticResource Style.Button.Horizontal}"/>

                            <n:ImageButton x:Name="TitleFrameButton" Grid.Row="1" Text="Title Frame" Content="{StaticResource Vector.TitleFrame}"
                                       Margin="0" Padding="2" MinWidth="60" MaxSize="25" VerticalContentAlignment="Center"
						               Command="util:Commands.TitleFrame" Style="{StaticResource Style.Button.Horizontal}"/>
                        </Grid>
                    </Grid>

                    <Separator Grid.Column="3" Grid.Row="0" Width="1" Height="Auto" HorizontalAlignment="Left" Margin="3,2"/>

                    <Grid Grid.Column="4" Margin="0,1,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <Label Grid.Column="0" Grid.Row="1" Grid.ColumnSpan="3" Content="Overlay" 
						       HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Padding="0" 
						       FontSize="12" Foreground="#FF707070"/>

                        <n:ImageButton x:Name="FreeDrawButton" Grid.Row="0" Grid.Column="0" Text="Free Drawing" Content="{StaticResource Vector.FreeDrawing}"
						               Margin="0" Padding="2" MinWidth="60" MaxWidth="65" MaxSize="30" VerticalContentAlignment="Top"
						               Command="util:Commands.FreeDrawing" Style="{StaticResource Style.Button.Vertical}" />

                        <Grid Grid.Row="0" Grid.Column="1">
                            <Grid.RowDefinitions>
                                <RowDefinition/>
                                <RowDefinition/>
                            </Grid.RowDefinitions>

                            <n:ImageButton x:Name="WatermarkButton" Grid.Row="0" Text="Watermark" Content="{StaticResource Vector.Watermark}"
                                       Margin="0" Padding="2" MinWidth="60" MaxSize="25" VerticalContentAlignment="Center"
						               Command="util:Commands.Watermark" Style="{StaticResource Style.Button.Horizontal}"/>

                            <n:ImageButton x:Name="CinemagraphButton" Grid.Row="1" Text="Cinemagraph" Content="{StaticResource Vector.Video}"
						               Margin="0" Padding="2" MinWidth="60" MaxSize="25" VerticalContentAlignment="Center"
						               Command="util:Commands.Cinemagraph" Style="{StaticResource Style.Button.Horizontal}" />
                        </Grid>

                        <n:ImageButton x:Name="BorderButton" Grid.Row="0" Grid.Column="2" Text="Border" Content="{StaticResource Vector.Border}"
						               Margin="0" Padding="2" MinWidth="60" MaxWidth="65" MaxSize="30" VerticalContentAlignment="Top"
						               Command="util:Commands.Border" Style="{StaticResource Style.Button.Vertical}" />
                    </Grid>

                    <Separator Grid.Column="5" Grid.Row="0" Width="1" Height="Auto" HorizontalAlignment="Left" Margin="3,2"/>

                    <Grid Grid.Column="6" Margin="0,1,0,0" Visibility="Collapsed">
                        <Grid.RowDefinitions>
                            <RowDefinition/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <Label Grid.Column="0" Grid.Row="1" Content="Filters" Padding="0" 
						       HorizontalContentAlignment="Center" VerticalContentAlignment="Center" FontSize="12" Foreground="#FF707070"/>

                        <n:DropDownButton Grid.Row="0" Grid.Column="0" x:Name="FilterButton"  Description="Filters" Content="{StaticResource Vector.Colors}" MaxSize="25" IsVertical="True"
                                          IsEnabled="{Binding ElementName=CropButton, Path=IsEnabled}">
                            <n:ImageMenuItem Header="Grayscale" Image="{StaticResource Vector.Video}" IsHitTestVisible="False" MaxSize="20"/>
                            <n:ImageMenuItem Header="Blur" Image="{StaticResource Vector.Video}" IsHitTestVisible="False" MaxSize="20"/>
                            <n:ImageMenuItem Header="Sepia" Image="{StaticResource Vector.Video}" IsHitTestVisible="False" MaxSize="20"/>
                        </n:DropDownButton>
                    </Grid>
                </Grid>
            </TabItem>
            <TabItem Header="Select">
                <Grid Height="94" Margin="2" Background="#FFFAFAFA">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition/>
                    </Grid.ColumnDefinitions>

                    <Grid Grid.Column="0" Margin="0,1,0,0">
                        <Grid.RowDefinitions>
                            <RowDefinition/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <Label Grid.Row="1" x:Name="SelectLabel" Content="General" 
						       HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Padding="0" 
						       FontSize="12" Foreground="#FF707070"/>

                        <n:ImageButton x:Name="SelectAllButton" Grid.Row="0" Text="Select All" Content="{StaticResource Vector.Info}"
						               Margin="0" Padding="2" MinWidth="60" MaxWidth="65" MaxSize="30" VerticalContentAlignment="Top"
						               Style="{StaticResource Style.Button.Vertical}" Command="util:Commands.SelectAll"/>
                    </Grid>

                    <Separator Grid.Column="1" Grid.Row="0" Width="1" Height="Auto" HorizontalAlignment="Left" Margin="3,2"/>

                    <Grid Grid.Column="2" Margin="0,1,0,0">
                        <Grid.RowDefinitions>
                            <RowDefinition/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <Label Grid.Row="1" x:Name="CurrentSelectionLabel" Content="Current" 
						       HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Padding="0" 
						       FontSize="12" Foreground="#FF707070"/>

                        <Grid Grid.Row="0">
                            <Grid.RowDefinitions>
                                <RowDefinition/>
                                <RowDefinition/>
                            </Grid.RowDefinitions>

                            <n:ImageButton x:Name="InverseSelectionButton" Grid.Row="0" Text="Inverse" Content="{StaticResource Vector.Info}"
                                       Margin="0" Padding="2" MinWidth="60" MaxSize="25" VerticalContentAlignment="Center"
						               Style="{StaticResource Style.Button.Horizontal}" Command="util:Commands.InverseSelection"/>

                            <n:ImageButton x:Name="DeselectButton" Grid.Row="1" Text="Deselect" Content="{StaticResource Vector.Info}"
                                       Margin="0" Padding="2" MinWidth="60" MaxSize="25" VerticalContentAlignment="Center"
						               Style="{StaticResource Style.Button.Horizontal}" Command="util:Commands.Unselect"/>
                        </Grid>
                    </Grid>
                </Grid>
            </TabItem>
            <TabItem Header="Playback">
                <Grid Height="94" Margin="2" Background="#FFFAFAFA"
                      IsEnabled="{Binding FilledList, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:Editor}}}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition/>
                    </Grid.ColumnDefinitions>

                    <Grid Grid.Column="0" Margin="0,1,0,0">
                        <Grid.RowDefinitions>
                            <RowDefinition/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <Label Grid.Column="0" Grid.Row="1" Grid.ColumnSpan="2" Content="Selected Frame" 
						    HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Padding="0" 
						    FontSize="12" Foreground="#FF707070"/>

                        <Viewbox Grid.Row="0" Grid.Column="0">
                            <Grid HorizontalAlignment="Center" VerticalAlignment="Center">
                                <n:CircularProgressBar StrokeThickness="2" Percentage="100" SegmentColor="Gray" Radius="24"/>
                                <n:CircularProgressBar StrokeThickness="2" Maximum="2510" Minimum="10" Value="{Binding ElementName=DelayNumericUpDown, Path=Value}" SegmentColor="#FFE28A73" Radius="24"/>
                                <n:CircularProgressBar StrokeThickness="22" Percentage="100" SegmentColor="#FFF0F1F1" Radius="10" />
                                <n:CircularProgressBar StrokeThickness="22" Maximum="2510" Minimum="10" Value="{Binding ElementName=DelayNumericUpDown, Path=Value}" SegmentColor="#FFE28A73" Radius="10" />
                            </Grid>
                        </Viewbox>

                        <Grid Grid.Row="0" Grid.Column="1">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition/>
                                <ColumnDefinition/>
                            </Grid.ColumnDefinitions>
                            
                            <n:NumericUpDown Grid.Column="0" x:Name="DelayNumericUpDown" Margin="0,3" StepValue="1" Minimum="10" Maximum="2500" 
                                         MinWidth="80" VerticalAlignment="Center" IsEnabled="{Binding Path=NotPreviewing, ElementName=EditorWindow}" 
                                         ValueChanged="NumericUpDown_OnValueChanged">
                                <n:NumericUpDown.ToolTip>
                                    <ToolTip HorizontalOffset="-5" Placement="Bottom" Content="Delay between the selected frame and the next one."/>
                                </n:NumericUpDown.ToolTip>
                            </n:NumericUpDown>

                            <Label Grid.Column="1" Content="ms" VerticalAlignment="Center" Padding="3"/>
                        </Grid>
                    </Grid>

                    <Separator Grid.Column="1" Grid.Row="0" Width="1" Height="Auto" HorizontalAlignment="Left" Margin="3,2"/>

                    <Grid Grid.Column="2" Margin="0,1,0,0">
                        <Grid.RowDefinitions>
                            <RowDefinition/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <Label Grid.Column="0" Grid.Row="1" Grid.ColumnSpan="2" Content="Multiple Frames" 
						       HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Padding="0" 
						       FontSize="12" Foreground="#FF707070"/>

                        <n:ImageButton Grid.Column="0" Grid.Row="0" x:Name="OverrideDelayButton" Text="Override Delay" Content="{StaticResource Vector.OverrideDelay}" 
							           Margin="0" Padding="3,3,3,0" MinWidth="60" MaxWidth="65" MaxSize="30" VerticalContentAlignment="Top"
							           Command="util:Commands.OverrideDelay" Style="{StaticResource Style.Button.Vertical}"/>
                        
                        <n:ImageButton Grid.Column="1" Grid.Row="0" x:Name="ChangeDelayButton" Text="Change Delay" Content="{StaticResource Vector.ChangeDelay}" 
							           Margin="0" Padding="3,3,3,0" MinWidth="60" MaxWidth="65" MaxSize="30" VerticalContentAlignment="Top"
							           Command="util:Commands.ChangeDelay" Style="{StaticResource Style.Button.Vertical}"/>
                    </Grid>

                    <Separator Grid.Column="3" Grid.Row="0" Width="1" Height="Auto" HorizontalAlignment="Left" Margin="3,2"/>
                </Grid>
            </TabItem>
            <TabItem Header="Options">
                <Grid Height="94" Margin="2" Background="#FFFAFAFA" Effect="{StaticResource Shadow.Invariant}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition/>
                    </Grid.ColumnDefinitions>

                    <Grid Grid.Column="0" Margin="0,1,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <Label Grid.Column="0" Grid.Row="1" Content="Application" 
						HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Padding="0" 
						FontSize="12" Foreground="#FF707070"/>

                        <n:ImageButton Grid.Row="0" Grid.Column="0" x:Name="OptionsButton" Text="Options" Content="{StaticResource Vector.Settings}"
						               Margin="0" Padding="1" MinWidth="60" MaxWidth="65" MaxSize="30" VerticalContentAlignment="Top"
						               Click="OptionsButton_Click" Style="{StaticResource Style.Button.Vertical}" />
                    </Grid>

                    <Separator Grid.Column="1" Width="1" Height="Auto" HorizontalAlignment="Left" Margin="3,2"/>

                    <Grid Grid.Column="2" Margin="0,1,0,0" Visibility="Collapsed">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition/>
                            <RowDefinition Height="20"/>
                        </Grid.RowDefinitions>

                        <Label Grid.Column="0" Grid.Row="1" Content="Features" 
						HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Padding="0" 
						FontSize="12" Foreground="#FF707070"/>

                    </Grid>

                    <Separator Grid.Column="3" Width="1" Height="Auto" HorizontalAlignment="Left" Margin="3,2" Visibility="Collapsed"/>
                </Grid>
            </TabItem>
        </n:HideableTabControl>

        <!--Middle of the Window-->
        <Grid Grid.Row="1" x:Name="MiddleGrid" Background="{StaticResource Checker.DrawingBrush}">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <n:ZoomBox Grid.Column="0" x:Name="ZoomBoxControl" Background="Transparent" ClipToBounds="True" Visibility="Collapsed" 
                       AllowDrop="True" Drop="Control_Drop" DragEnter="Control_DragEnter" PreviewMouseWheel="Grid_MouseWheel"/>

            <Grid Grid.Column="0" x:Name="OverlayGrid" Visibility="Collapsed" Opacity="0">
                <Label x:Name="OverlayLabel" Content="Preview" VerticalAlignment="Top" HorizontalAlignment="Left" 
                       FontSize="16" FontWeight="Light" Foreground="#FF347E4B" Effect="{StaticResource Shadow.Foreground.Small}"/>

                <Path x:Name="CropPath" VerticalAlignment="Center" HorizontalAlignment="Center" 
                      Width="{Binding ElementName=CaptionOverlayGrid, Path=Width, FallbackValue=0}" 
                      Height="{Binding ElementName=CaptionOverlayGrid, Path=Height, FallbackValue=0}"
                      Visibility="{Binding ElementName=CropGrid, Path=Visibility}" Fill="Black" Opacity=".5">
                    <Path.Data>
                        <CombinedGeometry GeometryCombineMode="Exclude">
                            <CombinedGeometry.Geometry1>
                                <RectangleGeometry>
                                    <RectangleGeometry.Rect>
                                        <MultiBinding Converter="{StaticResource IntToRectConverter}">
                                            <Binding ElementName="CaptionOverlayGrid" Path="Width" FallbackValue="0"/>
                                            <Binding ElementName="CaptionOverlayGrid" Path="Height" FallbackValue="0"/>
                                        </MultiBinding>
                                    </RectangleGeometry.Rect>
                                </RectangleGeometry>
                            </CombinedGeometry.Geometry1>
                            <CombinedGeometry.Geometry2>
                                <RectangleGeometry>
                                    <RectangleGeometry.Rect>
                                        <MultiBinding Converter="{StaticResource IntToRectConverter}">
                                            <Binding ElementName="LeftCropNumericUpDown" Path="Value" FallbackValue="0"/>
                                            <Binding ElementName="TopCropNumericUpDown" Path="Value" FallbackValue="0"/>
                                            <Binding ElementName="RightCropNumericUpDown" Path="Value" FallbackValue="0"/>
                                            <Binding ElementName="BottomCropNumericUpDown" Path="Value" FallbackValue="0"/>
                                        </MultiBinding>
                                    </RectangleGeometry.Rect>
                                </RectangleGeometry>
                            </CombinedGeometry.Geometry2>
                        </CombinedGeometry>
                    </Path.Data>
                </Path>

                <Grid x:Name="CaptionOverlayGrid" VerticalAlignment="Center" HorizontalAlignment="Center" ClipToBounds="True"
                      Visibility="{Binding ElementName=CaptionGrid, Path=Visibility}">
                    <n:TextPath x:Name="CaptionOverlayLabel" FontFamily="{Binding ElementName=CaptionFontComboBox, Path=SelectedItem}" 
                                FontStyle="{Binding ElementName=CaptionFontStyleComboBox, Path=SelectedItem}"
                                FontWeight="{Binding ElementName=CaptionFontWeightComboBox, Path=SelectedItem}"
                                FontSize="{Binding ElementName=CaptionFontSizeNumericUpDown, Path=Value}"
                                Fill="{Binding ElementName=CaptionFontColor, Path=Background}"
                                Stroke="{Binding ElementName=CaptionOutlineColor, Path=Background}"
                                StrokeThickness="{Binding ElementName=CaptionOutlineThicknessNumericUpDown, Path=Value}"
                                VerticalAlignment="{Binding ElementName=CaptionVerticalAligmentComboBox, Path=SelectedItem}"
                                HorizontalAlignment="{Binding ElementName=CaptionHorizontalAligmentComboBox, Path=SelectedItem}"
                                Margin="{Binding ElementName=CaptionMarginNumericUpDown, Path=Value}"
                                Text="{Binding ElementName=CaptionTextBox, Path=Text}"/>
                </Grid>

                <Canvas x:Name="FreeTextOverlayCanvas" VerticalAlignment="Center" HorizontalAlignment="Center" ClipToBounds="True"
                        Width="{Binding ElementName=CaptionOverlayGrid, Path=Width, FallbackValue=0}" 
                        Height="{Binding ElementName=CaptionOverlayGrid, Path=Height, FallbackValue=0}"
                        Visibility="{Binding ElementName=FreeTextGrid, Path=Visibility}">
                    <TextBlock x:Name="FreeTextTextBlock" Padding="0" Cursor="ScrollAll"
                               Text="{Binding ElementName=FreeTextTextBox, Path=Text}" 
                               FontFamily="{Binding ElementName=FreeTextFontComboBox, Path=SelectedItem}" 
                               FontStyle="{Binding ElementName=FreeTextFontStyleComboBox, Path=SelectedItem}"
                               FontWeight="{Binding ElementName=FreeTextFontWeightComboBox, Path=SelectedItem}"
                               FontSize="{Binding ElementName=FreeTextFontSizeNumericUpDown, Path=Value}"
                               Foreground="{Binding ElementName=FreeTextFontColor, Path=Background}" 
                               MouseLeftButtonDown="FreeTextTextBlock_OnMouseLeftButtonDown"
                               MouseLeftButtonUp="FreeTextTextBlock_OnMouseLeftButtonUp"
                               MouseMove="FreeTextTextBlock_OnMouseMove"/>
                </Canvas>

                <Grid x:Name="TitleFrameOverlayGrid" VerticalAlignment="Center" HorizontalAlignment="Center" ClipToBounds="True"
                      Width="{Binding ElementName=CaptionOverlayGrid, Path=Width, FallbackValue=0}" 
                      Height="{Binding ElementName=CaptionOverlayGrid, Path=Height, FallbackValue=0}"
                      Visibility="{Binding ElementName=TitleFrameGrid, Path=Visibility}" 
                      Background="{Binding ElementName=TitleFrameBackgroundColor, Path=Background}">
                    <TextBlock x:Name="TitleFrameTextBlock" Padding="0"
                               Text="{Binding ElementName=TitleFrameTextBox, Path=Text}" 
                               FontFamily="{Binding ElementName=TitleFrameFontComboBox, Path=SelectedItem}" 
                               FontStyle="{Binding ElementName=TitleFrameFontStyleComboBox, Path=SelectedItem}"
                               FontWeight="{Binding ElementName=TitleFrameFontWeightComboBox, Path=SelectedItem}"
                               FontSize="{Binding ElementName=TitleFrameFontSizeNumericUpDown, Path=Value}"
                               Foreground="{Binding ElementName=TitleFrameFontColor, Path=Background}"
                               VerticalAlignment="{Binding ElementName=TitleFrameVerticalAligmentComboBox, Path=SelectedItem}"
                               HorizontalAlignment="{Binding ElementName=TitleFrameHorizontalAligmentComboBox, Path=SelectedItem}"
                               Margin="{Binding ElementName=TitleFrameMarginNumericUpDown, Path=Value}"/>
                </Grid>

                <n:InkCanvasExtended x:Name="FreeDrawingInkCanvas" VerticalAlignment="Center" HorizontalAlignment="Center" ClipToBounds="True"
                                     Width="{Binding ElementName=CaptionOverlayGrid, Path=Width, FallbackValue=0}" MinWidth="10" 
                                     Height="{Binding ElementName=CaptionOverlayGrid, Path=Height, FallbackValue=0}" MinHeight="10"
                                     Visibility="{Binding ElementName=FreeDrawingGrid, Path=Visibility}" Background="Transparent" >

                    <n:InkCanvasExtended.EditingMode>
                        <MultiBinding Converter="{StaticResource SelectionToEditingModeConverter}">
                            <Binding ElementName="PenModeRadioButton" Path="IsChecked"/>
                            <Binding ElementName="EraserModeRadioButton" Path="IsChecked"/>
                            <Binding ElementName="SelectorModeRadioButton" Path="IsChecked"/>
                        </MultiBinding>
                    </n:InkCanvasExtended.EditingMode>

                    <n:InkCanvasExtended.DefaultDrawingAttributes>
                        <MultiBinding Converter="{StaticResource SelectionToDrawingAttributesConverter}">
                            <Binding ElementName="FreeDrawingHeightNumericUpDown" Path="Value"/>
                            <Binding ElementName="FreeDrawingWidthNumericUpDown" Path="Value"/>
                            <Binding ElementName="FreeDrawingColorBorder" Path="Background"/>
                            <Binding ElementName="FitToCurveCheckBox" Path="IsChecked"/>
                            <Binding ElementName="IsHighLighterCheckBox" Path="IsChecked"/>
                            <Binding ElementName="RectangleRadioButton" Path="IsChecked"/>
                        </MultiBinding>
                    </n:InkCanvasExtended.DefaultDrawingAttributes>

                    <n:InkCanvasExtended.EraserShape>
                        <MultiBinding Converter="{StaticResource SelectionToStylusShapeConverter}">
                            <Binding ElementName="FreeDrawingEraserWidthNumericUpDown" Path="Value"/>
                            <Binding ElementName="FreeDrawingEraserHeightNumericUpDown" Path="Value"/>
                            <Binding ElementName="RectangleEraserRadioButton" Path="IsChecked"/>
                        </MultiBinding>
                    </n:InkCanvasExtended.EraserShape>
                </n:InkCanvasExtended>

                <Grid x:Name="WatermarkOverlayGrid" VerticalAlignment="Center" HorizontalAlignment="Center" ClipToBounds="True" 
                      Width="{Binding ElementName=CaptionOverlayGrid, Path=Width, FallbackValue=0}" 
                      Height="{Binding ElementName=CaptionOverlayGrid, Path=Height, FallbackValue=0}"
                      Visibility="{Binding ElementName=WatermarkGrid, Path=Visibility}">

                    <Image Source="{Binding Source={x:Static prop:Settings.Default}, Path=WatermarkFilePath, Converter={StaticResource UriToBitmapConverter}}"
                           Opacity="{Binding Source={x:Static prop:Settings.Default}, Path=WatermarkOpacity}"
                           VerticalAlignment="{Binding Source={x:Static prop:Settings.Default}, Path=WatermarkVerticalAligment}"
                           HorizontalAlignment="{Binding Source={x:Static prop:Settings.Default}, Path=WatermarkHorizontalAligment}" 
                           Margin="{Binding ElementName=WatermarkMarginNumericUpDown, Path=Value}" RenderTransformOrigin="0.5,0.5"
                           Stretch="None" Width="{Binding RelativeSource={RelativeSource Self}, Path=(Source).ActualWidth}"
                           Height="{Binding RelativeSource={RelativeSource Self}, Path=(Source).ActualHeight}">
                        <Image.RenderTransform>
                            <ScaleTransform ScaleX="{Binding Source={x:Static prop:Settings.Default}, Path=WatermarkSize}" 
                                            ScaleY="{Binding Source={x:Static prop:Settings.Default}, Path=WatermarkSize}"/>
                        </Image.RenderTransform>
                    </Image>
                </Grid>

                <Border x:Name="BorderOverlayBorder" VerticalAlignment="Center" HorizontalAlignment="Center"
                        Width="{Binding ElementName=CaptionOverlayGrid, Path=Width, FallbackValue=0}" 
                        Height="{Binding ElementName=CaptionOverlayGrid, Path=Height, FallbackValue=0}"
                        Visibility="{Binding ElementName=BorderGrid, Path=Visibility}"
                        BorderBrush="{Binding ElementName=BorderColorBorder, Path=Background}">
                    <Border.BorderThickness>
                        <MultiBinding Converter="{StaticResource DoubleToThicknessConverter}">
                            <Binding ElementName="BorderLeftThicknessNumericUpDown" Path="Value"/>
                            <Binding ElementName="BorderTopThicknessNumericUpDown" Path="Value"/>
                            <Binding ElementName="BorderRightThicknessNumericUpDown" Path="Value"/>
                            <Binding ElementName="BorderBottomThicknessNumericUpDown" Path="Value"/>
                        </MultiBinding>
                    </Border.BorderThickness>
                </Border>

                <n:InkCanvasExtended x:Name="CinemagraphInkCanvas" VerticalAlignment="Center" HorizontalAlignment="Center" ClipToBounds="True"
                                     Width="{Binding ElementName=CaptionOverlayGrid, Path=Width, FallbackValue=0}" MinWidth="10" 
                                     Height="{Binding ElementName=CaptionOverlayGrid, Path=Height, FallbackValue=0}" MinHeight="10"
                                     Visibility="{Binding ElementName=CinemagraphGrid, Path=Visibility}" Background="Transparent" >

                    <n:InkCanvasExtended.EditingMode>
                        <MultiBinding Converter="{StaticResource SelectionToEditingModeConverter}">
                            <Binding ElementName="PenMode2RadioButton" Path="IsChecked"/>
                            <Binding ElementName="EraserMode2RadioButton" Path="IsChecked"/>
                            <Binding ElementName="SelectorMode2RadioButton" Path="IsChecked"/>
                        </MultiBinding>
                    </n:InkCanvasExtended.EditingMode>

                    <n:InkCanvasExtended.DefaultDrawingAttributes>
                        <MultiBinding Converter="{StaticResource SelectionToDrawingAttributesConverter}">
                            <Binding ElementName="CinemagraphHeightNumericUpDown" Path="Value"/>
                            <Binding ElementName="CinemagraphWidthNumericUpDown" Path="Value"/>
                            <Binding Source="{x:Static prop:Settings.Default}" Path="CinemagraphColor"/>
                            <Binding ElementName="FitToCurve2CheckBox" Path="IsChecked"/>
                            <Binding Source="{x:Static prop:Settings.Default}" Path="CinemagraphIsHighlighter"/>
                            <Binding ElementName="Rectangle2RadioButton" Path="IsChecked"/>
                        </MultiBinding>
                    </n:InkCanvasExtended.DefaultDrawingAttributes>

                    <n:InkCanvasExtended.EraserShape>
                        <MultiBinding Converter="{StaticResource SelectionToStylusShapeConverter}">
                            <Binding ElementName="CinemagraphEraserWidthNumericUpDown" Path="Value"/>
                            <Binding ElementName="CinemagraphEraserHeightNumericUpDown" Path="Value"/>
                            <Binding ElementName="RectangleEraser2RadioButton" Path="IsChecked"/>
                        </MultiBinding>
                    </n:InkCanvasExtended.EraserShape>
                </n:InkCanvasExtended>
            </Grid>

            <Grid Grid.Column="0" x:Name="WelcomeGrid" Background="WhiteSmoke" Visibility="Visible" AllowDrop="True" Drop="Control_Drop" DragEnter="Control_DragEnter">
                <TextBlock x:Name="WelcomeTextBlock" Text=";D" Foreground="#FFD0D0D0" FontSize="40" FontFamily="Segoe UI Semilight" 
                       TextWrapping="WrapWithOverflow" VerticalAlignment="Center" HorizontalAlignment="Center" Effect="{StaticResource Shadow.Foreground.Small}"/>
            </Grid>

            <Grid Grid.Column="1" x:Name="ActionGrid" Width="0" Background="#FFFAFAFA" Effect="{StaticResource Shadow.Background}">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!--Title-->
                <Grid Grid.Row="0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <Viewbox Grid.Column="0" x:Name="ActionViewBox" Margin="5,5,0,5" MinWidth="20" MaxHeight="20" Stretch="Uniform" 
                             Child="{StaticResource Vector.Info}" />

                    <Label Grid.Column="1" x:Name="ActionTitleLabel" Content="Title" Padding="5,0,0,0" VerticalAlignment="Center"/>

                    <n:ImageButton Grid.Column="2" x:Name="HideButton" Content="{DynamicResource Vector.Close}" MaxSize="16" HorizontalContentAlignment="Center" HorizontalAlignment="Center"
                                               Style="{DynamicResource Style.Button.NoText}" Text="" MinWidth="30">
                        <n:ImageButton.ToolTip>
                            <ToolTip Content="Hide" Placement="Top" HorizontalOffset="-5"/>
                        </n:ImageButton.ToolTip>

                        <n:ImageButton.Triggers>
                            <EventTrigger RoutedEvent="Button.Click">
                                <BeginStoryboard Storyboard="{StaticResource HidePanelStoryboard}" HandoffBehavior="Compose"/>
                                <BeginStoryboard Storyboard="{StaticResource HideOverlayGridStoryboard}" HandoffBehavior="Compose"/>
                            </EventTrigger>
                        </n:ImageButton.Triggers>
                    </n:ImageButton>
                </Grid>

                <!--Content-->
                <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                    <StackPanel x:Name="ActionStackPanel">
                        <Grid x:Name="NewGrid" Visibility="Collapsed">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <Label Grid.Row="0" Content="Size" Style="{StaticResource LabelSeparator}"/>
                            <Grid Grid.Row="1" Margin="10,0,0,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <Label Grid.Row="0" Grid.Column="0" Content="Width:" VerticalAlignment="Center" Padding="0"/>
                                <n:NumericUpDown Grid.Row="0" Grid.Column="1" x:Name="NewImageWidthNumericUpDown" Minimum="10" Maximum="2000" Margin="10,5" MinWidth="80" 
                                             Value="{Binding Source={x:Static prop:Settings.Default}, Path=NewImageWidth, Mode=TwoWay}"/>

                                <Label Grid.Row="1" Grid.Column="0" Content="Height:" VerticalAlignment="Center" Padding="0"/>
                                <n:NumericUpDown Grid.Row="1" Grid.Column="1" x:Name="NewImageHeightNumericUpDown" Minimum="10" Maximum="2000" Margin="10,5" MinWidth="80" 
                                             Value="{Binding Source={x:Static prop:Settings.Default}, Path=NewImageHeight, Mode=TwoWay}"/>
                            </Grid>

                            <Label Grid.Row="2" Content="Background" Style="{StaticResource LabelSeparator}"/>
                            <Grid Grid.Row="3" Margin="10,0,0,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <Label Grid.Row="1" Grid.Column="0" Content="Color:" VerticalAlignment="Center" Padding="0"/>
                                <Border Grid.Row="1" Grid.Column="1" x:Name="NewImageBackgroundColor" Height="26" Margin="10,5" Cursor="Hand" 
                                        BorderBrush="#FFABABAB" BorderThickness="1" Background="{Binding NewImageColor, Source={x:Static prop:Settings.Default}, 
                                        Converter={StaticResourceExtension ColorToBrush}, Mode=TwoWay}" MinWidth="70" 
                                        MouseLeftButtonDown="NewAnimationBackgroundColor_MouseLeftButtonDown"/>
                            </Grid>

                            <Grid Grid.Row="4">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <n:ImageButton Grid.Column="1" x:Name="ApplyNewImageButton" Text="Apply" Padding="10,5" MinWidth="90" MinHeight="20"
                                  Margin="5,5,5,5" Click="ApplyNewImageButton_Click" MaxSize="20" Content="{StaticResource Vector.Ok}"/>
                            </Grid>
                        </Grid>
                        <Grid x:Name="ClipboardGrid" Visibility="Collapsed">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <ListBox x:Name="ClipboardListView" Margin="5" Height="80" ScrollViewer.HorizontalScrollBarVisibility="Disabled"/>

                            <Label Grid.Row="1" Content="Paste Behavior" Margin="5,0" Padding="0,5"/>
                            <RadioButton Grid.Row="2" x:Name="PasteBeforeRadioButton" Content="Before selected frame" Margin="10,5,5,5" IsChecked="True"/>
                            <RadioButton Grid.Row="3" x:Name="PasteAfterRadioButton" Content="After selected frame" Margin="10,5,5,5"/>
                        </Grid>
                        <Grid x:Name="ResizeGrid" Visibility="Collapsed">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <Label Grid.Row="0" Content="Current Properties" Style="{StaticResource LabelSeparator}"/>
                            <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="10,0,0,0">
                                <Label x:Name="CurrentWidthLabel" Content="100"/>
                                <Label Content="x"/>
                                <Label x:Name="CurrentHeightLabel" Content="100"/>
                                <Label Content="•"/>
                                <Label x:Name="CurrentDpiLabel" Content="100"/>
                                <Label Content="Dpi"/>
                            </StackPanel>

                            <Label Grid.Row="2" Content="New Properties" Style="{StaticResource LabelSeparator}"/>
                            <Grid Grid.Row="3" Margin="10,0,0,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <Label Grid.Row="0" Grid.Column="0" Content="DPI:" VerticalAlignment="Center" Padding="0"/>
                                <n:NumericUpDown Grid.Row="0" Grid.Column="1" x:Name="DpiNumericUpDown" Minimum="72" Maximum="200" Margin="10,5" MinWidth="70"/>

                                <Label Grid.Row="1" Grid.Column="0" Content="Width:" VerticalAlignment="Center" Padding="0"/>
                                <n:NumericUpDown Grid.Row="1" Grid.Column="1" x:Name="WidthResizeNumericUpDown" Minimum="1" Maximum="2000" Margin="10,5" 
                                                 MinWidth="70" ValueChanged="WidthResizeNumericUpDown_ValueChanged"/>

                                <Label Grid.Row="2" Grid.Column="0" Content="Height:" VerticalAlignment="Center" Padding="0"/>
                                <n:NumericUpDown Grid.Row="2" Grid.Column="1" x:Name="HeightResizeNumericUpDown" Minimum="1" Maximum="2000" Margin="10,5" 
                                                 MinWidth="70" ValueChanged="HeightResizeNumericUpDown_ValueChanged"/>

                                <Viewbox Grid.Row="1" Grid.Column="2" Grid.RowSpan="2" Child="{StaticResource Vector.No}" MaxHeight="25"
                                     Visibility="{Binding ElementName=KeepAspectCheckBox, Path=IsChecked, Converter={StaticResource Bool2VisibilityConverter}}"/>
                            </Grid>

                            <CheckBox Grid.Row="4" x:Name="KeepAspectCheckBox" Content="Keep aspect ratio." Margin="10,5" IsChecked="True" 
                                      Checked="KeepAspectCheckBox_Checked"/>

                            <Grid Grid.Row="5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <n:ImageButton Grid.Column="1" x:Name="ApplyResizeButton" Text="Apply" Padding="10,5" MinWidth="90" MinHeight="20"
                                  Margin="5,5,5,5" Click="ApplyResizeButton_Click" MaxSize="20" Content="{StaticResource Vector.Ok}"/>
                            </Grid>
                        </Grid>
                        <Grid x:Name="CropGrid" Visibility="Collapsed">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <Label Grid.Row="0" Content="Points" Style="{StaticResource LabelSeparator}"/>
                            <Grid Grid.Row="1" Margin="10,0,0,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <Label Grid.Row="0" Grid.Column="0" Content="Top:" VerticalAlignment="Center" Padding="0"/>
                                <n:NumericUpDown Grid.Row="0" Grid.Column="1" x:Name="TopCropNumericUpDown" Minimum="0" Margin="10,5" MinWidth="70" 
                                                 Value="{Binding Source={x:Static prop:Settings.Default}, Path=TitleFrameMargin}">
                                    <n:NumericUpDown.Maximum>
                                        <MultiBinding Converter="{StaticResource MaximumValueConverter}" Mode="OneWay">
                                            <Binding RelativeSource="{RelativeSource Mode=Self}" Path="Minimum" FallbackValue="0"/>
                                            <Binding ElementName="BottomCropNumericUpDown" Path="Value" />
                                            <Binding ElementName="BottomCropNumericUpDown" Path="Minimum" FallbackValue="0"/>
                                        </MultiBinding>
                                    </n:NumericUpDown.Maximum>
                                </n:NumericUpDown>

                                <Label Grid.Row="1" Grid.Column="0" Content="Left:" VerticalAlignment="Center" Padding="0"/>
                                <n:NumericUpDown Grid.Row="1" Grid.Column="1" x:Name="LeftCropNumericUpDown" Minimum="0" Margin="10,5" MinWidth="70" 
                                                 Value="{Binding Source={x:Static prop:Settings.Default}, Path=TitleFrameMargin}">
                                    <n:NumericUpDown.Maximum>
                                        <MultiBinding Converter="{StaticResource MaximumValueConverter}" Mode="OneWay">
                                            <Binding RelativeSource="{RelativeSource Mode=Self}" Path="Minimum" FallbackValue="0"/>
                                            <Binding ElementName="RightCropNumericUpDown" Path="Value" />
                                            <Binding ElementName="RightCropNumericUpDown" Path="Minimum" FallbackValue="0"/>
                                        </MultiBinding>
                                    </n:NumericUpDown.Maximum>
                                </n:NumericUpDown>

                                <Label Grid.Row="2" Grid.Column="0" Content="Bottom:" VerticalAlignment="Center" Padding="0"/>
                                <n:NumericUpDown Grid.Row="2" Grid.Column="1" x:Name="BottomCropNumericUpDown" Minimum="10"
                                                 Margin="10,5" MinWidth="70" 
                                             Value="{Binding Source={x:Static prop:Settings.Default}, Path=TitleFrameMargin}">
                                    <n:NumericUpDown.Maximum>
                                        <MultiBinding Converter="{StaticResource MaximumValueConverter}">
                                            <Binding RelativeSource="{RelativeSource Mode=Self}" Path="Minimum" FallbackValue="0"/>
                                            <Binding ElementName="CropPath" Path="Height" FallbackValue="0"/>
                                            <!--<Binding ElementName="TopCropNumericUpDown" Path="Value" FallbackValue="0"/>-->
                                        </MultiBinding>
                                    </n:NumericUpDown.Maximum>
                                </n:NumericUpDown>

                                <Label Grid.Row="3" Grid.Column="0" Content="Right:" VerticalAlignment="Center" Padding="0"/>
                                <n:NumericUpDown Grid.Row="3" Grid.Column="1" x:Name="RightCropNumericUpDown" Minimum="10"
                                                 Margin="10,5" MinWidth="70" 
                                                 Value="{Binding Source={x:Static prop:Settings.Default}, Path=TitleFrameMargin}">
                                    <n:NumericUpDown.Maximum>
                                        <MultiBinding Converter="{StaticResource MaximumValueConverter}" Mode="OneWay">
                                            <Binding RelativeSource="{RelativeSource Mode=Self}" Path="Minimum" FallbackValue="0"/>
                                            <Binding ElementName="CropPath" Path="Width" FallbackValue="0"/>
                                            <!--<Binding ElementName="LeftCropNumericUpDown" Path="Value" FallbackValue="0"/>-->
                                        </MultiBinding>
                                    </n:NumericUpDown.Maximum>
                                </n:NumericUpDown>
                            </Grid>

                            <Grid Grid.Row="4">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <n:ImageButton Grid.Column="1" x:Name="ApplyCropButton" Text="Apply" Padding="10,5" MinWidth="90" MinHeight="20"
                                               Margin="5,5,5,5" Click="ApplyCropButton_Click" MaxSize="20" Content="{StaticResource Vector.Ok}"/>
                            </Grid>
                        </Grid>
                        <Grid x:Name="FlipRotateGrid" Visibility="Collapsed">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <Label Grid.Row="0" Content="Flip/Rotate" Style="{StaticResource LabelSeparator}"/>
                            <Grid Grid.Row="1" Margin="10,0" HorizontalAlignment="Center">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <n:ImageRadioButton Grid.Row="0" x:Name="FlipHorizontalRadioButton" Text="Flip Horizontal"
                                                    Content="{StaticResource Vector.FlipHorizontal}" Cursor="Hand" MaxSize="25" Padding="0,5"
                                                    IsChecked="True"/>

                                <n:ImageRadioButton Grid.Row="1" x:Name="FlipVerticalRadioButton" Text="Flip Vertical"
                                                    Content="{StaticResource Vector.FlipVertical}" Cursor="Hand" MaxSize="25" Padding="0,5"/>


                                <n:ImageRadioButton Grid.Row="2" x:Name="RotateLeftRadioButton" Text="Rotate Left 90°"
                                                    Content="{StaticResource Vector.RotateLeft90}" Cursor="Hand" MaxSize="25" Padding="0,5"/>


                                <n:ImageRadioButton Grid.Row="3" x:Name="RotateRightRadioButton" Text="Rotate Right 90°"
                                                    Content="{StaticResource Vector.RotateRight90}" Cursor="Hand" MaxSize="25" Padding="0,5"/>
                            </Grid>

                            <Grid Grid.Row="2">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <n:ImageButton Grid.Column="1" x:Name="ApplyFlipRotateButton" Text="Apply" Padding="10,5" MinWidth="90" MinHeight="20"
                                               Margin="5,5,5,5" Click="ApplyFlipRotateButton_Click" MaxSize="20" Content="{StaticResource Vector.Ok}"/>
                            </Grid>
                        </Grid>
                        <Grid x:Name="CaptionGrid" Visibility="Collapsed">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <Label Grid.Row="0" Content="Text" Style="{StaticResource LabelSeparator}"/>
                            <TextBox Grid.Row="1" x:Name="CaptionTextBox"  Margin="10,5,5,5" AcceptsReturn="True" AcceptsTab="True"
                                 Text="{Binding Source={x:Static prop:Settings.Default}, Path=CaptionText}"/>

                            <Label Grid.Row="2" Content="Font" Style="{StaticResource LabelSeparator}"/>
                            <Grid Grid.Row="3" Margin="10,0,0,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <Label Grid.Row="0" Grid.Column="0" Content="Family:" VerticalAlignment="Center" Padding="0"/>
                                <ComboBox Grid.Row="0" Grid.Column="1" x:Name="CaptionFontComboBox" Margin="10,5" MinWidth="100" MaxWidth="110" IsEditable="True"
                                      ItemTemplate="{DynamicResource FontTemplate}" SelectedItem="{Binding Source={x:Static prop:Settings.Default}, Path=CaptionFontFamily}">
                                    <ComboBox.ItemsSource>
                                        <Binding Source="{StaticResource MyFonts}" />
                                    </ComboBox.ItemsSource>
                                </ComboBox>

                                <Label Grid.Row="1" Grid.Column="0" Content="Style:" VerticalAlignment="Center" Padding="0"/>
                                <ComboBox Grid.Row="1" Grid.Column="1" x:Name="CaptionFontStyleComboBox" Margin="10,5" MinWidth="100" MaxWidth="110" IsEditable="True"
                                      ItemTemplate="{DynamicResource FontTemplate}" SelectedItem="{Binding Source={x:Static prop:Settings.Default}, Path=CaptionFontStyle}">
                                    <ComboBox.Resources>
                                        <Style x:Key="FontStyle">
                                            <Setter Property="Control.FontStyle" Value="{Binding .}"/>
                                            <Setter Property="Control.FontSize" Value="14" />
                                        </Style>

                                        <DataTemplate x:Key="FontTemplate">
                                            <VirtualizingStackPanel IsVirtualizing="True" VirtualizationMode="Recycling" ScrollViewer.IsDeferredScrollingEnabled="True">
                                                <TextBlock Style="{StaticResource FontStyle}" Text="{Binding .}" />
                                            </VirtualizingStackPanel>
                                        </DataTemplate>
                                    </ComboBox.Resources>

                                    <x:Static Member="FontStyles.Normal"/>
                                    <x:Static Member="FontStyles.Italic"/>
                                    <x:Static Member="FontStyles.Oblique"/>
                                </ComboBox>

                                <Label Grid.Row="2" Grid.Column="0" Content="Weight:" VerticalAlignment="Center" Padding="0"/>
                                <ComboBox Grid.Row="2" Grid.Column="1" x:Name="CaptionFontWeightComboBox" Margin="10,5" MinWidth="100" MaxWidth="110" 
                                      ItemTemplate="{DynamicResource FontTemplate}" SelectedItem="{Binding Source={x:Static prop:Settings.Default}, Path=CaptionFontWeight}">
                                    <ComboBox.Resources>
                                        <Style x:Key="FontStyle">
                                            <Setter Property="Control.FontWeight" Value="{Binding .}"/>
                                            <Setter Property="Control.FontSize" Value="14" />
                                        </Style>

                                        <DataTemplate x:Key="FontTemplate">
                                            <VirtualizingStackPanel IsVirtualizing="True" VirtualizationMode="Recycling" ScrollViewer.IsDeferredScrollingEnabled="True">
                                                <TextBlock Style="{StaticResource FontStyle}" Text="{Binding .}" />
                                            </VirtualizingStackPanel>
                                        </DataTemplate>
                                    </ComboBox.Resources>

                                    <x:Static Member="FontWeights.Black"/>
                                    <x:Static Member="FontWeights.Bold"/>
                                    <x:Static Member="FontWeights.DemiBold"/>
                                    <x:Static Member="FontWeights.ExtraBlack"/>
                                    <x:Static Member="FontWeights.ExtraBold"/>
                                    <x:Static Member="FontWeights.ExtraLight"/>
                                    <x:Static Member="FontWeights.Heavy"/>
                                    <x:Static Member="FontWeights.Light"/>
                                    <x:Static Member="FontWeights.Medium"/>
                                    <x:Static Member="FontWeights.Normal"/>
                                    <x:Static Member="FontWeights.Regular"/>
                                    <x:Static Member="FontWeights.SemiBold"/>
                                    <x:Static Member="FontWeights.Thin"/>
                                    <x:Static Member="FontWeights.UltraBlack"/>
                                    <x:Static Member="FontWeights.UltraBold"/>
                                    <x:Static Member="FontWeights.UltraLight"/>
                                </ComboBox>

                                <Label Grid.Row="3" Grid.Column="0" Content="Size:" VerticalAlignment="Center" Padding="0"/>
                                <n:NumericUpDown Grid.Row="3" Grid.Column="1" x:Name="CaptionFontSizeNumericUpDown" Minimum="10" Maximum="1000" Margin="10,5" MinWidth="70" 
                                             Value="{Binding Source={x:Static prop:Settings.Default}, Path=CaptionFontSize}"/>

                                <Label Grid.Row="4" Grid.Column="0" Content="Color:" VerticalAlignment="Center" Padding="0"/>
                                <Border Grid.Row="4" Grid.Column="1" x:Name="CaptionFontColor" Height="26" Margin="10,5" Cursor="Hand" BorderBrush="#FFABABAB" BorderThickness="1"
                                    Background="{Binding CaptionFontColor, Source={x:Static prop:Settings.Default}, Converter={StaticResourceExtension ColorToBrush}, Mode=TwoWay}" MouseLeftButtonDown="CaptionFontColor_MouseLeftButtonDown"/>
                            </Grid>

                            <Label Grid.Row="4" Content="Outline" Style="{StaticResource LabelSeparator}"/>
                            <Grid Grid.Row="5" Margin="10,0,0,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <Label Grid.Row="0" Grid.Column="0" Content="Thickness:" VerticalAlignment="Center" Padding="0"/>
                                <n:NumericUpDown Grid.Row="0" Grid.Column="1" x:Name="CaptionOutlineThicknessNumericUpDown" Minimum="1" Maximum="20" Margin="10,5" MinWidth="70" 
                                             Value="{Binding Source={x:Static prop:Settings.Default}, Path=CaptionOutlineThickness}"/>

                                <Label Grid.Row="1" Grid.Column="0" Content="Color:" VerticalAlignment="Center" Padding="0"/>
                                <Border Grid.Row="1" Grid.Column="1" x:Name="CaptionOutlineColor" Height="26" Margin="10,5" Cursor="Hand" BorderBrush="#FFABABAB" BorderThickness="1"
                                        Background="{Binding CaptionOutlineColor, Source={x:Static prop:Settings.Default}, Converter={StaticResourceExtension ColorToBrush}, Mode=TwoWay}"
                                        MouseLeftButtonDown="CaptionOutlineColor_MouseLeftButtonDown"/>
                            </Grid>

                            <Label Grid.Row="6" Content="Layout" Style="{StaticResource LabelSeparator}"/>
                            <Grid Grid.Row="7" Margin="10,0,0,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <Label Grid.Row="0" Grid.Column="0" Content="Vertical:" VerticalAlignment="Center" Padding="0"/>
                                <ComboBox Grid.Row="0" Grid.Column="1" x:Name="CaptionVerticalAligmentComboBox" Margin="10,5" MinWidth="100" MaxWidth="110"
                                      SelectedItem="{Binding Source={x:Static prop:Settings.Default}, Path=CaptionVerticalAligment}">
                                    <x:Static Member="VerticalAlignment.Top"/>
                                    <x:Static Member="VerticalAlignment.Center"/>
                                    <x:Static Member="VerticalAlignment.Bottom"/>
                                </ComboBox>

                                <Label Grid.Row="1" Grid.Column="0" Content="Horizontal:" VerticalAlignment="Center" Padding="0"/>
                                <ComboBox Grid.Row="1" Grid.Column="1" x:Name="CaptionHorizontalAligmentComboBox" Margin="10,5" MinWidth="100" MaxWidth="110" 
                                      SelectedItem="{Binding Source={x:Static prop:Settings.Default}, Path=CaptionHorizontalAligment}">
                                    <x:Static Member="HorizontalAlignment.Left"/>
                                    <x:Static Member="HorizontalAlignment.Center"/>
                                    <x:Static Member="HorizontalAlignment.Right"/>
                                </ComboBox>

                                <Label Grid.Row="2" Grid.Column="0" Content="Margin:" VerticalAlignment="Center" Padding="0"/>
                                <n:NumericUpDown Grid.Row="2" Grid.Column="1" x:Name="CaptionMarginNumericUpDown" Minimum="-100" Maximum="100" Margin="10,5" MinWidth="70" 
                                             Value="{Binding Source={x:Static prop:Settings.Default}, Path=CaptionMargin}"/>
                            </Grid>

                            <Grid Grid.Row="8">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <n:ImageButton Grid.Column="1" x:Name="ApplyCaptionButton" Text="Apply" Padding="10,5" MinWidth="90" MinHeight="20"
                                  Margin="5,5,5,5" Click="ApplyCaptionButton_Click" MaxSize="20" Content="{StaticResource Vector.Ok}"/>
                            </Grid>
                        </Grid>
                        <Grid x:Name="FreeTextGrid" Visibility="Collapsed">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <Label Grid.Row="0" Content="Text" Style="{StaticResource LabelSeparator}"/>
                            <TextBox Grid.Row="1" x:Name="FreeTextTextBox"  Margin="10,5,5,5" AcceptsReturn="True" AcceptsTab="True"
                                 Text="{Binding Source={x:Static prop:Settings.Default}, Path=FreeTextText}"/>

                            <Label Grid.Row="2" Content="Font" Style="{StaticResource LabelSeparator}"/>
                            <Grid Grid.Row="3" Margin="10,0,0,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <Label Grid.Row="0" Grid.Column="0" Content="Family:" VerticalAlignment="Center" Padding="0"/>
                                <ComboBox Grid.Row="0" Grid.Column="1" x:Name="FreeTextFontComboBox" Margin="10,5" MinWidth="100" MaxWidth="110"  IsEditable="True"
                                          ItemTemplate="{DynamicResource FontTemplate}" SelectedItem="{Binding Source={x:Static prop:Settings.Default}, Path=FreeTextFontFamily}">
                                    <ComboBox.ItemsSource>
                                        <Binding Source="{StaticResource MyFonts}" />
                                    </ComboBox.ItemsSource>
                                </ComboBox>

                                <Label Grid.Row="1" Grid.Column="0" Content="Style:" VerticalAlignment="Center" Padding="0"/>
                                <ComboBox Grid.Row="1" Grid.Column="1" x:Name="FreeTextFontStyleComboBox" Margin="10,5" MinWidth="100" MaxWidth="110" IsEditable="True"
                                      ItemTemplate="{DynamicResource FontTemplate}" SelectedItem="{Binding Source={x:Static prop:Settings.Default}, Path=FreeTextFontStyle}">
                                    <ComboBox.Resources>
                                        <Style x:Key="FontStyle">
                                            <Setter Property="Control.FontStyle" Value="{Binding .}"/>
                                            <Setter Property="Control.FontSize" Value="14" />
                                        </Style>

                                        <DataTemplate x:Key="FontTemplate">
                                            <VirtualizingStackPanel IsVirtualizing="True" VirtualizationMode="Recycling" ScrollViewer.IsDeferredScrollingEnabled="True">
                                                <TextBlock Style="{StaticResource FontStyle}" Text="{Binding .}" />
                                            </VirtualizingStackPanel>
                                        </DataTemplate>
                                    </ComboBox.Resources>

                                    <x:Static Member="FontStyles.Normal"/>
                                    <x:Static Member="FontStyles.Italic"/>
                                    <x:Static Member="FontStyles.Oblique"/>
                                </ComboBox>

                                <Label Grid.Row="2" Grid.Column="0" Content="Weight:" VerticalAlignment="Center" Padding="0"/>
                                <ComboBox Grid.Row="2" Grid.Column="1" x:Name="FreeTextFontWeightComboBox" Margin="10,5" MinWidth="100" MaxWidth="110" IsEditable="True"
                                      ItemTemplate="{DynamicResource FontTemplate}" SelectedItem="{Binding Source={x:Static prop:Settings.Default}, Path=FreeTextFontWeight}">
                                    <ComboBox.Resources>
                                        <Style x:Key="FontStyle">
                                            <Setter Property="Control.FontWeight" Value="{Binding .}"/>
                                            <Setter Property="Control.FontSize" Value="14" />
                                        </Style>

                                        <DataTemplate x:Key="FontTemplate">
                                            <VirtualizingStackPanel IsVirtualizing="True" VirtualizationMode="Recycling" ScrollViewer.IsDeferredScrollingEnabled="True">
                                                <TextBlock Style="{StaticResource FontStyle}" Text="{Binding .}" />
                                            </VirtualizingStackPanel>
                                        </DataTemplate>
                                    </ComboBox.Resources>

                                    <x:Static Member="FontWeights.Black"/>
                                    <x:Static Member="FontWeights.Bold"/>
                                    <x:Static Member="FontWeights.DemiBold"/>
                                    <x:Static Member="FontWeights.ExtraBlack"/>
                                    <x:Static Member="FontWeights.ExtraBold"/>
                                    <x:Static Member="FontWeights.ExtraLight"/>
                                    <x:Static Member="FontWeights.Heavy"/>
                                    <x:Static Member="FontWeights.Light"/>
                                    <x:Static Member="FontWeights.Medium"/>
                                    <x:Static Member="FontWeights.Normal"/>
                                    <x:Static Member="FontWeights.Regular"/>
                                    <x:Static Member="FontWeights.SemiBold"/>
                                    <x:Static Member="FontWeights.Thin"/>
                                    <x:Static Member="FontWeights.UltraBlack"/>
                                    <x:Static Member="FontWeights.UltraBold"/>
                                    <x:Static Member="FontWeights.UltraLight"/>
                                </ComboBox>

                                <Label Grid.Row="3" Grid.Column="0" Content="Size:" VerticalAlignment="Center" Padding="0"/>
                                <n:NumericUpDown Grid.Row="3" Grid.Column="1" x:Name="FreeTextFontSizeNumericUpDown" Minimum="10" Maximum="1000" Margin="10,5" MinWidth="70" 
                                             Value="{Binding Source={x:Static prop:Settings.Default}, Path=FreeTextFontSize}"/>

                                <Label Grid.Row="4" Grid.Column="0" Content="Color:" VerticalAlignment="Center" Padding="0"/>
                                <Border Grid.Row="4" Grid.Column="1" x:Name="FreeTextFontColor" Height="26" Margin="10,5" Cursor="Hand" BorderBrush="#FFABABAB" BorderThickness="1"
                                    Background="{Binding FreeTextFontColor, Source={x:Static prop:Settings.Default}, Converter={StaticResourceExtension ColorToBrush}, Mode=TwoWay}" 
                                        MouseLeftButtonDown="FreeTextFontColor_MouseLeftButtonDown"/>
                            </Grid>

                            <Label Grid.Row="4" Content="Layout" Style="{StaticResource LabelSeparator}"/>
                            <Grid Grid.Row="5" Margin="10,0,0,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <Label Grid.Row="0" Grid.Column="0" Content="Left:" VerticalAlignment="Center" Padding="0"/>
                                <n:NumericUpDown Grid.Row="0" Grid.Column="1" x:Name="FreeTextPositionXNumericUpDown" Minimum="-2000" Maximum="2000" Margin="10,5" MinWidth="70"
                                                 Value="{Binding ElementName=FreeTextTextBlock, Path=(Canvas.Left), Converter={StaticResource DoubleToIntConverter}, Mode=TwoWay, FallbackValue=0}"/>

                                <Label Grid.Row="1" Grid.Column="0" Content="Top:" VerticalAlignment="Center" Padding="0"/>
                                <n:NumericUpDown Grid.Row="1" Grid.Column="1" x:Name="FreeTextPositionYNumericUpDown" Minimum="-2000" Maximum="2000" Margin="10,5" MinWidth="70"
                                                 Value="{Binding ElementName=FreeTextTextBlock, Path=(Canvas.Top), Converter={StaticResource DoubleToIntConverter}, Mode=TwoWay, FallbackValue=0}"/>
                            </Grid>

                            <Grid Grid.Row="6">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <n:ImageButton Grid.Column="1" x:Name="ApplyFreeTextButton" Text="Apply" Padding="10,5" MinWidth="90" MinHeight="20"
                                  Margin="5,5,5,5" Click="ApplyFreeTextButton_Click" MaxSize="20" Content="{StaticResource Vector.Ok}"/>
                            </Grid>
                        </Grid>
                        <Grid x:Name="TitleFrameGrid" Visibility="Collapsed">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <Label Grid.Row="0" Content="Text" Style="{StaticResource LabelSeparator}"/>
                            <TextBox Grid.Row="1" x:Name="TitleFrameTextBox"  Margin="10,5,5,5" AcceptsReturn="True" AcceptsTab="True"
                                 Text="{Binding Source={x:Static prop:Settings.Default}, Path=TitleFrameText}"/>

                            <Label Grid.Row="2" Content="Font" Style="{StaticResource LabelSeparator}"/>
                            <Grid Grid.Row="3" Margin="10,0,0,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <Label Grid.Row="0" Grid.Column="0" Content="Family:" VerticalAlignment="Center" Padding="0"/>
                                <ComboBox Grid.Row="0" Grid.Column="1" x:Name="TitleFrameFontComboBox" Margin="10,5" MinWidth="100" MaxWidth="110"  IsEditable="True"
                                          ItemTemplate="{DynamicResource FontTemplate}" SelectedItem="{Binding Source={x:Static prop:Settings.Default}, Path=TitleFrameFontFamily}">
                                    <ComboBox.ItemsSource>
                                        <Binding Source="{StaticResource MyFonts}" />
                                    </ComboBox.ItemsSource>
                                </ComboBox>

                                <Label Grid.Row="1" Grid.Column="0" Content="Style:" VerticalAlignment="Center" Padding="0"/>
                                <ComboBox Grid.Row="1" Grid.Column="1" x:Name="TitleFrameFontStyleComboBox" Margin="10,5" MinWidth="100" MaxWidth="110" IsEditable="True"
                                      ItemTemplate="{DynamicResource FontTemplate}" SelectedItem="{Binding Source={x:Static prop:Settings.Default}, Path=TitleFrameFontStyle}">
                                    <ComboBox.Resources>
                                        <Style x:Key="FontStyle">
                                            <Setter Property="Control.FontStyle" Value="{Binding .}"/>
                                            <Setter Property="Control.FontSize" Value="14" />
                                        </Style>

                                        <DataTemplate x:Key="FontTemplate">
                                            <VirtualizingStackPanel IsVirtualizing="True" VirtualizationMode="Recycling" ScrollViewer.IsDeferredScrollingEnabled="True">
                                                <TextBlock Style="{StaticResource FontStyle}" Text="{Binding .}" />
                                            </VirtualizingStackPanel>
                                        </DataTemplate>
                                    </ComboBox.Resources>

                                    <x:Static Member="FontStyles.Normal"/>
                                    <x:Static Member="FontStyles.Italic"/>
                                    <x:Static Member="FontStyles.Oblique"/>
                                </ComboBox>

                                <Label Grid.Row="2" Grid.Column="0" Content="Weight:" VerticalAlignment="Center" Padding="0"/>
                                <ComboBox Grid.Row="2" Grid.Column="1" x:Name="TitleFrameFontWeightComboBox" Margin="10,5" MinWidth="100" MaxWidth="110" IsEditable="True"
                                      ItemTemplate="{DynamicResource FontTemplate}" SelectedItem="{Binding Source={x:Static prop:Settings.Default}, Path=TitleFrameFontWeight}">
                                    <ComboBox.Resources>
                                        <Style x:Key="FontStyle">
                                            <Setter Property="Control.FontWeight" Value="{Binding .}"/>
                                            <Setter Property="Control.FontSize" Value="14" />
                                        </Style>

                                        <DataTemplate x:Key="FontTemplate">
                                            <VirtualizingStackPanel IsVirtualizing="True" VirtualizationMode="Recycling" ScrollViewer.IsDeferredScrollingEnabled="True">
                                                <TextBlock Style="{StaticResource FontStyle}" Text="{Binding .}" />
                                            </VirtualizingStackPanel>
                                        </DataTemplate>
                                    </ComboBox.Resources>

                                    <x:Static Member="FontWeights.Black"/>
                                    <x:Static Member="FontWeights.Bold"/>
                                    <x:Static Member="FontWeights.DemiBold"/>
                                    <x:Static Member="FontWeights.ExtraBlack"/>
                                    <x:Static Member="FontWeights.ExtraBold"/>
                                    <x:Static Member="FontWeights.ExtraLight"/>
                                    <x:Static Member="FontWeights.Heavy"/>
                                    <x:Static Member="FontWeights.Light"/>
                                    <x:Static Member="FontWeights.Medium"/>
                                    <x:Static Member="FontWeights.Normal"/>
                                    <x:Static Member="FontWeights.Regular"/>
                                    <x:Static Member="FontWeights.SemiBold"/>
                                    <x:Static Member="FontWeights.Thin"/>
                                    <x:Static Member="FontWeights.UltraBlack"/>
                                    <x:Static Member="FontWeights.UltraBold"/>
                                    <x:Static Member="FontWeights.UltraLight"/>
                                </ComboBox>

                                <Label Grid.Row="3" Grid.Column="0" Content="Size:" VerticalAlignment="Center" Padding="0"/>
                                <n:NumericUpDown Grid.Row="3" Grid.Column="1" x:Name="TitleFrameFontSizeNumericUpDown" Minimum="10" Maximum="1000" Margin="10,5" MinWidth="70" 
                                             Value="{Binding Source={x:Static prop:Settings.Default}, Path=TitleFrameFontSize}"/>

                                <Label Grid.Row="4" Grid.Column="0" Content="Color:" VerticalAlignment="Center" Padding="0"/>
                                <Border Grid.Row="4" Grid.Column="1" x:Name="TitleFrameFontColor" Height="26" Margin="10,5" Cursor="Hand" BorderBrush="#FFABABAB" BorderThickness="1"
                                    Background="{Binding TitleFrameFontColor, Source={x:Static prop:Settings.Default}, Converter={StaticResourceExtension ColorToBrush}, Mode=TwoWay}" 
                                        MouseLeftButtonDown="TitleFrameFontColor_MouseLeftButtonDown"/>
                            </Grid>

                            <Label Grid.Row="4" Content="Layout" Style="{StaticResource LabelSeparator}"/>
                            <Grid Grid.Row="5" Margin="10,0,0,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <Label Grid.Row="0" Grid.Column="0" Content="Vertical:" VerticalAlignment="Center" Padding="0"/>
                                <ComboBox Grid.Row="0" Grid.Column="1" x:Name="TitleFrameVerticalAligmentComboBox" Margin="10,5" MinWidth="100" MaxWidth="110"
                                      SelectedItem="{Binding Source={x:Static prop:Settings.Default}, Path=CaptionVerticalAligment}">
                                    <x:Static Member="VerticalAlignment.Top"/>
                                    <x:Static Member="VerticalAlignment.Center"/>
                                    <x:Static Member="VerticalAlignment.Bottom"/>
                                </ComboBox>

                                <Label Grid.Row="1" Grid.Column="0" Content="Horizontal:" VerticalAlignment="Center" Padding="0"/>
                                <ComboBox Grid.Row="1" Grid.Column="1" x:Name="TitleFrameHorizontalAligmentComboBox" Margin="10,5" MinWidth="100" MaxWidth="110" 
                                      SelectedItem="{Binding Source={x:Static prop:Settings.Default}, Path=CaptionHorizontalAligment}">
                                    <x:Static Member="HorizontalAlignment.Left"/>
                                    <x:Static Member="HorizontalAlignment.Center"/>
                                    <x:Static Member="HorizontalAlignment.Right"/>
                                </ComboBox>

                                <Label Grid.Row="2" Grid.Column="0" Content="Margin:" VerticalAlignment="Center" Padding="0"/>
                                <n:NumericUpDown Grid.Row="2" Grid.Column="1" x:Name="TitleFrameMarginNumericUpDown" Minimum="-100" Maximum="100" Margin="10,5" MinWidth="70" 
                                             Value="{Binding Source={x:Static prop:Settings.Default}, Path=TitleFrameMargin}"/>
                            </Grid>

                            <Label Grid.Row="6" Content="Background" Style="{StaticResource LabelSeparator}"/>
                            <Grid Grid.Row="7" Margin="10,0,0,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <Label Grid.Row="0" Grid.Column="0" Content="Color:" VerticalAlignment="Center" Padding="0"/>
                                <Border Grid.Row="0" Grid.Column="1" x:Name="TitleFrameBackgroundColor" Height="26" Margin="10,5" Cursor="Hand" BorderBrush="#FFABABAB" BorderThickness="1"
                                        Background="{Binding TitleFrameBackgroundColor, Source={x:Static prop:Settings.Default}, Converter={StaticResourceExtension ColorToBrush}, Mode=TwoWay}" 
                                        MouseLeftButtonDown="TitleFrameBackgroundColor_MouseLeftButtonDown" MinWidth="100"/>
                            </Grid>

                            <Grid Grid.Row="8">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <n:ImageButton Grid.Column="1" x:Name="ApplyTitleFrameButton" Text="Apply" Padding="10,5" MinWidth="90" MinHeight="20"
                                               Margin="5,5,5,5" Click="ApplyTitleFrameButton_Click" MaxSize="20" Content="{StaticResource Vector.Ok}"/>
                            </Grid>
                        </Grid>
                        <Grid x:Name="FreeDrawingGrid" Visibility="Collapsed">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <Label Grid.Row="0" Content="Mode" Style="{StaticResource LabelSeparator}"/>
                            <Grid Grid.Row="1" Margin="10,0,0,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="*"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition/>
                                    <ColumnDefinition/>
                                </Grid.ColumnDefinitions>

                                <n:ImageRadioButton Grid.Row="0" Grid.Column="0" x:Name="PenModeRadioButton" Content="{StaticResource Vector.Pen}" 
                                                    Text="Pen" Cursor="Hand" MaxSize="20" Margin="0,3" Padding="0,5" IsChecked="True"/>
                                <n:ImageRadioButton Grid.Row="0" Grid.Column="1" x:Name="EraserModeRadioButton" Content="{StaticResource Vector.Eraser}" 
                                                    Text="Eraser" Cursor="Hand" MaxSize="20" Margin="0,3" Padding="0,5"/>

                                <n:ImageRadioButton Grid.Row="1" Grid.Column="0" x:Name="SelectorModeRadioButton" Content="{StaticResource Vector.Select}" 
                                                    Text="Select" Cursor="Hand" MaxSize="20" Margin="0,3" Padding="0,5"/>
                                <n:ImageRadioButton Grid.Row="1" Grid.Column="1" x:Name="EraserStrokeModeRadioButton" Content="{StaticResource Vector.StrokeEraser}" 
                                                    Text="Stroke Eraser" Cursor="Hand" MaxSize="20" Margin="0,3" Padding="0,5"/>
                            </Grid>

                            <Label Grid.Row="2" Content="Pen" Style="{StaticResource LabelSeparator}" 
                                   Visibility="{Binding ElementName=PenModeRadioButton, Path=IsChecked, Converter={StaticResource Bool2VisibilityConverter}}"/>
                            <Grid Grid.Row="3" Margin="10,0,0,0" 
                                  Visibility="{Binding ElementName=PenModeRadioButton, Path=IsChecked, Converter={StaticResource Bool2VisibilityConverter}}">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <Label Grid.Row="0" Grid.Column="0" Content="Width:" VerticalAlignment="Center" Padding="0"/>
                                <n:NumericUpDown Grid.Row="0" Grid.Column="1" x:Name="FreeDrawingWidthNumericUpDown" Minimum="1" Maximum="100" Margin="10,5" MinWidth="70" 
                                             Value="{Binding Source={x:Static prop:Settings.Default}, Path=FreeDrawingPenWidth}"/>

                                <Label Grid.Row="1" Grid.Column="0" Content="Height:" VerticalAlignment="Center" Padding="0"/>
                                <n:NumericUpDown Grid.Row="1" Grid.Column="1" x:Name="FreeDrawingHeightNumericUpDown" Minimum="1" Maximum="100" Margin="10,5" MinWidth="70" 
                                             Value="{Binding Source={x:Static prop:Settings.Default}, Path=FreeDrawingPenHeight}"/>

                                <Label Grid.Row="2" Grid.Column="0" Content="Color:" VerticalAlignment="Center" Padding="0"/>
                                <Border Grid.Row="2" Grid.Column="1" x:Name="FreeDrawingColorBorder" Height="26" Margin="10,5" Cursor="Hand" BorderBrush="#FFABABAB" BorderThickness="1"
                                        Background="{Binding FreeDrawingColor, Source={x:Static prop:Settings.Default}, Converter={StaticResource ColorToBrush}, Mode=TwoWay}" 
                                        MouseLeftButtonDown="FreeDrawingColorBorder_MouseLeftButtonDown"/>

                                <Label Grid.Row="3" Grid.Column="0" Content="Tip:" VerticalAlignment="Center" Padding="0"/>
                                <Grid Grid.Row="3" Grid.Column="1" Grid.ColumnSpan="2">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition/>
                                        <ColumnDefinition/>
                                    </Grid.ColumnDefinitions>

                                    <n:ImageRadioButton Grid.Row="0" Grid.Column="0" x:Name="RectangleRadioButton" Content="{StaticResource Vector.Rectangle}" 
                                                        Text="Rectangle" Cursor="Hand" MaxSize="20" Margin="3,3" Padding="0,5"
                                                        IsChecked="{Binding FreeDrawingStylusTip, Source={x:Static prop:Settings.Default}, 
                                                        Converter={StaticResource StylusTipToBoolConverter}, ConverterParameter=Rectangle}"/>
                                    <n:ImageRadioButton Grid.Row="0" Grid.Column="1" x:Name="EllipseRadioButton" Content="{StaticResource Vector.Ellipse}" 
                                                        Text="Ellipse" Cursor="Hand" MaxSize="20" Margin="0,3" Padding="0,5"
                                                        IsChecked="{Binding FreeDrawingStylusTip, Source={x:Static prop:Settings.Default}, 
                                                        Converter={StaticResource StylusTipToBoolConverter}, ConverterParameter=Ellipse}"/>
                                </Grid>

                                <Label Grid.Row="4" Grid.Column="0" Content="Other:" VerticalAlignment="Center" Padding="0"/>
                                <CheckBox Grid.Row="4" Grid.Column="1" Grid.ColumnSpan="2" x:Name="IsHighLighterCheckBox" Content="Is Highlighter" Margin="5"
                                          IsChecked="{Binding Source={x:Static prop:Settings.Default}, Path=FreeDrawingIsHighlighter}"/>
                                <CheckBox Grid.Row="5" Grid.Column="1" Grid.ColumnSpan="2" x:Name="FitToCurveCheckBox" Content="Fit To Curve" Margin="5"
                                          IsChecked="{Binding Source={x:Static prop:Settings.Default}, Path=FreeDrawingFitToCurve}"/>
                            </Grid>

                            <Label Grid.Row="4" Content="Eraser" Style="{StaticResource LabelSeparator}"
                                   Visibility="{Binding ElementName=EraserModeRadioButton, Path=IsChecked, Converter={StaticResource Bool2VisibilityConverter}}"/>
                            <Grid Grid.Row="5" Margin="10,0,0,0"
                                  Visibility="{Binding ElementName=EraserModeRadioButton, Path=IsChecked, Converter={StaticResource Bool2VisibilityConverter}}">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <Label Grid.Row="0" Grid.Column="0" Content="Width:" VerticalAlignment="Center" Padding="0"/>
                                <n:NumericUpDown Grid.Row="0" Grid.Column="1" x:Name="FreeDrawingEraserWidthNumericUpDown" Minimum="1" Maximum="100" Margin="10,5" MinWidth="70" 
                                             Value="{Binding Source={x:Static prop:Settings.Default}, Path=FreeDrawingEraserWidth}"/>

                                <Label Grid.Row="1" Grid.Column="0" Content="Height:" VerticalAlignment="Center" Padding="0"/>
                                <n:NumericUpDown Grid.Row="1" Grid.Column="1" x:Name="FreeDrawingEraserHeightNumericUpDown" Minimum="1" Maximum="100" Margin="10,5" MinWidth="70" 
                                             Value="{Binding Source={x:Static prop:Settings.Default}, Path=FreeDrawingEraserHeight}"/>

                                <Label Grid.Row="2" Grid.Column="0" Content="Tip:" VerticalAlignment="Center" Padding="0"/>
                                <Grid Grid.Row="2" Grid.Column="1" Grid.ColumnSpan="2">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition/>
                                        <ColumnDefinition/>
                                    </Grid.ColumnDefinitions>

                                    <n:ImageRadioButton Grid.Row="0" Grid.Column="0" x:Name="RectangleEraserRadioButton" Content="{StaticResource Vector.Rectangle}" 
                                                        Text="Rectangle" Cursor="Hand" MaxSize="20" Margin="3,3" Padding="0,5"
                                                        IsChecked="{Binding FreeDrawingEraserStylusTip, Source={x:Static prop:Settings.Default}, 
                                                        Converter={StaticResource StylusTipToBoolConverter}, ConverterParameter=Rectangle}"/>
                                    <n:ImageRadioButton Grid.Row="0" Grid.Column="1" x:Name="ElipseEraserRadioButton" Content="{StaticResource Vector.Ellipse}" 
                                                        Text="Elipse" Cursor="Hand" MaxSize="20" Margin="0,3" Padding="0,5"
                                                        IsChecked="{Binding FreeDrawingEraserStylusTip, Source={x:Static prop:Settings.Default}, 
                                                        Converter={StaticResource StylusTipToBoolConverter}, ConverterParameter=Ellipse}"/>
                                </Grid>
                            </Grid>

                            <Grid Grid.Row="6">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <n:ImageButton Grid.Column="1" x:Name="ApplyFreeDrawingButton" Text="Apply" Padding="10,5" MinWidth="90" MinHeight="20"
                                  Margin="5,5,5,5" Click="ApplyFreeDrawingButton_Click" MaxSize="20" Content="{StaticResource Vector.Ok}"/>
                            </Grid>
                        </Grid>
                        <Grid x:Name="WatermarkGrid" Visibility="Collapsed">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <Label Grid.Row="0" Content="Image" Style="{StaticResource LabelSeparator}"/>
                            <Grid Grid.Row="1" Margin="10,0,0,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <Label Grid.Row="0" Grid.Column="0" Content="File:" VerticalAlignment="Center" Padding="0"/>
                                <TextBlock Grid.Row="0" Grid.Column="1" x:Name="ImagePathLabel" Margin="3" Padding="0" FontStyle="Italic" Foreground="#FF09012B" VerticalAlignment="Center"
                                           Text="{Binding Source={x:Static prop:Settings.Default}, Path=WatermarkFilePath, Converter={StaticResource PathToFilenameConverter}}" TextWrapping="WrapWithOverflow"
                                           ToolTip="{Binding Source={x:Static prop:Settings.Default}, Path=WatermarkFilePath}" ToolTipService.Placement="Top" ToolTipService.HorizontalOffset="-5"/>
                                <n:ImageButton Grid.Row="0" Grid.Column="2" x:Name="SelectWatermarkButton" Content="{StaticResource Vector.Image}" MaxSize="20" Text="Select" 
                                               Margin="5,3" Padding="2,5" Click="SelectWatermark_Click"/>

                                <Label Grid.Row="1" Grid.Column="0" Content="Opacity:" VerticalAlignment="Center" Padding="0"/>
                                <n:NumericUpDown Grid.Row="1" Grid.Column="1" x:Name="OpacityWatermarkNumericUpDown" Minimum="1" Maximum="100" Margin="10,5" MaxWidth="70" 
                                                 Value="{Binding Source={x:Static prop:Settings.Default}, Path=WatermarkOpacity, 
                                                 Converter={StaticResource DoubleTimesAHundredToIntConverter}, Mode=TwoWay, FallbackValue=70}"/>

                                <Label Grid.Row="2" Grid.Column="0" Content="Size:" VerticalAlignment="Center" Padding="0"/>
                                <n:NumericUpDown Grid.Row="2" Grid.Column="1" x:Name="SizeWatermarkNumericUpDown" Minimum="1" Maximum="200" Margin="10,5" MaxWidth="70"  
                                             Value="{Binding Source={x:Static prop:Settings.Default}, Path=WatermarkSize, 
                                    Converter={StaticResource DoubleTimesAHundredToIntConverter}, Mode=TwoWay, FallbackValue=100}"/>
                            </Grid>

                            <Label Grid.Row="2" Content="Layout" Style="{StaticResource LabelSeparator}"/>
                            <Grid Grid.Row="3" Margin="10,0,0,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <Label Grid.Row="0" Grid.Column="0" Content="Vertical:" VerticalAlignment="Center" Padding="0"/>
                                <ComboBox Grid.Row="0" Grid.Column="1" x:Name="WatermarkVerticalAligmentComboBox" Margin="10,5" MinWidth="100" MaxWidth="110"
                                      SelectedItem="{Binding Source={x:Static prop:Settings.Default}, Path=WatermarkVerticalAligment}">
                                    <x:Static Member="VerticalAlignment.Top"/>
                                    <x:Static Member="VerticalAlignment.Center"/>
                                    <x:Static Member="VerticalAlignment.Bottom"/>
                                </ComboBox>

                                <Label Grid.Row="1" Grid.Column="0" Content="Horizontal:" VerticalAlignment="Center" Padding="0"/>
                                <ComboBox Grid.Row="1" Grid.Column="1" x:Name="WatermarkHorizontalAligmentComboBox" Margin="10,5" MinWidth="100" MaxWidth="110" 
                                      SelectedItem="{Binding Source={x:Static prop:Settings.Default}, Path=WatermarkHorizontalAligment}">
                                    <x:Static Member="HorizontalAlignment.Left"/>
                                    <x:Static Member="HorizontalAlignment.Center"/>
                                    <x:Static Member="HorizontalAlignment.Right"/>
                                </ComboBox>

                                <Label Grid.Row="2" Grid.Column="0" Content="Margin:" VerticalAlignment="Center" Padding="0"/>
                                <n:NumericUpDown Grid.Row="2" Grid.Column="1" x:Name="WatermarkMarginNumericUpDown" Minimum="-100" Maximum="100" Margin="10,5" MinWidth="70" 
                                             Value="{Binding Source={x:Static prop:Settings.Default}, Path=WatermarkMargin}"/>
                            </Grid>

                            <Grid Grid.Row="4">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <n:ImageButton Grid.Column="1" x:Name="ApplyWatermarkButton" Text="Apply" Padding="10,5" MinWidth="90" MinHeight="20"
                                               Margin="5,5,5,5" Click="ApplyWatermarkButton_Click" MaxSize="20" Content="{StaticResource Vector.Ok}"/>
                            </Grid>
                        </Grid>
                        <Grid x:Name="BorderGrid" Visibility="Collapsed">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <Label Grid.Row="0" Content="Appearance" Style="{StaticResource LabelSeparator}"/>
                            <Grid Grid.Row="1" Margin="10,0,0,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <Label Grid.Row="0" Grid.Column="0" Content="Color:" VerticalAlignment="Center" Padding="0"/>
                                <Border Grid.Row="0" Grid.Column="1" x:Name="BorderColorBorder" Height="26" Margin="10,5" Cursor="Hand" BorderBrush="#FFABABAB" BorderThickness="1"
                                        Background="{Binding BorderColor, Source={x:Static prop:Settings.Default}, Converter={StaticResourceExtension ColorToBrush}, Mode=TwoWay}" 
                                        MouseLeftButtonDown="BorderColor_MouseLeftButtonDown" MinWidth="100"/>

                                <Label Grid.Row="1" Grid.Column="0" Content="Thickness:" VerticalAlignment="Center" Padding="0"/>
                                <Grid Grid.Row="1" Grid.Column="1">
                                    <Grid.RowDefinitions>
                                        <RowDefinition/>
                                        <RowDefinition/>
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition/>
                                    </Grid.ColumnDefinitions>

                                    <Viewbox Grid.Row="0" Grid.Column="0" Child="{StaticResource Vector.Arrow.Blue.Left}" MaxWidth="15" MaxHeight="15"/>
                                    <Viewbox Grid.Row="1" Grid.Column="0" Child="{StaticResource Vector.Arrow.Blue.Top}" MaxWidth="15" MaxHeight="15"/>

                                    <n:NumericUpDown Grid.Row="0" Grid.Column="1" x:Name="BorderLeftThicknessNumericUpDown" Minimum="0" Maximum="10" Margin="3,5" Width="55" 
                                             Value="{Binding Source={x:Static prop:Settings.Default}, Path=BorderLeftThickness, Mode=TwoWay}"/>
                                    <n:NumericUpDown Grid.Row="1" Grid.Column="1" x:Name="BorderTopThicknessNumericUpDown" Minimum="0" Maximum="10" Margin="3,5" Width="55" 
                                             Value="{Binding Source={x:Static prop:Settings.Default}, Path=BorderTopThickness, Mode=TwoWay}"/>

                                    <Viewbox Grid.Row="0" Grid.Column="2" Child="{StaticResource Vector.Arrow.Blue.Right}" MaxWidth="15" MaxHeight="15"/>
                                    <Viewbox Grid.Row="1" Grid.Column="2" Child="{StaticResource Vector.Arrow.Blue.Bottom}" MaxWidth="15" MaxHeight="15"/>

                                    <n:NumericUpDown Grid.Row="0" Grid.Column="3" x:Name="BorderRightThicknessNumericUpDown" Minimum="0" Maximum="10" Margin="3,5" Width="55" 
                                             Value="{Binding Source={x:Static prop:Settings.Default}, Path=BorderRightThickness, Mode=TwoWay}"/>
                                    <n:NumericUpDown Grid.Row="1" Grid.Column="3" x:Name="BorderBottomThicknessNumericUpDown" Minimum="0" Maximum="10" Margin="3,5" Width="55" 
                                             Value="{Binding Source={x:Static prop:Settings.Default}, Path=BorderBottomThickness, Mode=TwoWay}"/>
                                </Grid>
                            </Grid>

                            <Grid Grid.Row="2">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <n:ImageButton Grid.Column="1" x:Name="ApplyBorderButton" Text="Apply" Padding="10,5" MinWidth="90" MinHeight="20"
                                               Margin="5,5,5,5" Click="ApplyBorderButton_Click" MaxSize="20" Content="{StaticResource Vector.Ok}"/>
                            </Grid>
                        </Grid>
                        <Grid x:Name="CinemagraphGrid" Visibility="Collapsed">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <Label Grid.Row="0" Content="Mode" Style="{StaticResource LabelSeparator}"/>
                            <Grid Grid.Row="1" Margin="10,0,0,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="*"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition/>
                                    <ColumnDefinition/>
                                </Grid.ColumnDefinitions>

                                <n:ImageRadioButton Grid.Row="0" Grid.Column="0" x:Name="PenMode2RadioButton" Content="{StaticResource Vector.Pen}" 
                                                    Text="Pen" Cursor="Hand" MaxSize="20" Margin="0,3" Padding="0,5" IsChecked="True"/>
                                <n:ImageRadioButton Grid.Row="0" Grid.Column="1" x:Name="EraserMode2RadioButton" Content="{StaticResource Vector.Eraser}" 
                                                    Text="Eraser" Cursor="Hand" MaxSize="20" Margin="0,3" Padding="0,5"/>

                                <n:ImageRadioButton Grid.Row="1" Grid.Column="0" x:Name="SelectorMode2RadioButton" Content="{StaticResource Vector.Select}" 
                                                    Text="Select" Cursor="Hand" MaxSize="20" Margin="0,3" Padding="0,5"/>
                                <n:ImageRadioButton Grid.Row="1" Grid.Column="1" x:Name="EraserStrokeMode2RadioButton" Content="{StaticResource Vector.StrokeEraser}" 
                                                    Text="Stroke Eraser" Cursor="Hand" MaxSize="20" Margin="0,3" Padding="0,5"/>
                            </Grid>

                            <Label Grid.Row="2" Content="Pen" Style="{StaticResource LabelSeparator}" 
                                   Visibility="{Binding ElementName=PenMode2RadioButton, Path=IsChecked, Converter={StaticResource Bool2VisibilityConverter}}"/>
                            <Grid Grid.Row="3" Margin="10,0,0,0" 
                                  Visibility="{Binding ElementName=PenMode2RadioButton, Path=IsChecked, Converter={StaticResource Bool2VisibilityConverter}}">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <Label Grid.Row="0" Grid.Column="0" Content="Width:" VerticalAlignment="Center" Padding="0"/>
                                <n:NumericUpDown Grid.Row="0" Grid.Column="1" x:Name="CinemagraphWidthNumericUpDown" Minimum="1" Maximum="100" Margin="10,5" MinWidth="70" 
                                             Value="{Binding Source={x:Static prop:Settings.Default}, Path=CinemagraphPenWidth}"/>

                                <Label Grid.Row="1" Grid.Column="0" Content="Height:" VerticalAlignment="Center" Padding="0"/>
                                <n:NumericUpDown Grid.Row="1" Grid.Column="1" x:Name="CinemagraphHeightNumericUpDown" Minimum="1" Maximum="100" Margin="10,5" MinWidth="70" 
                                             Value="{Binding Source={x:Static prop:Settings.Default}, Path=CinemagraphPenHeight}"/>

                                <Label Grid.Row="2" Grid.Column="0" Content="Tip:" VerticalAlignment="Center" Padding="0"/>
                                <Grid Grid.Row="2" Grid.Column="1" Grid.ColumnSpan="2">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition/>
                                        <ColumnDefinition/>
                                    </Grid.ColumnDefinitions>

                                    <n:ImageRadioButton Grid.Row="0" Grid.Column="0" x:Name="Rectangle2RadioButton" Content="{StaticResource Vector.Rectangle}" 
                                                        Text="Rectangle" Cursor="Hand" MaxSize="20" Margin="3,3" Padding="0,5"
                                                        IsChecked="{Binding CinemagraphStylusTip, Source={x:Static prop:Settings.Default}, 
                                                        Converter={StaticResource StylusTipToBoolConverter}, ConverterParameter=Rectangle}"/>
                                    <n:ImageRadioButton Grid.Row="0" Grid.Column="1" x:Name="Ellipse2RadioButton" Content="{StaticResource Vector.Ellipse}" 
                                                        Text="Ellipse" Cursor="Hand" MaxSize="20" Margin="0,3" Padding="0,5"
                                                        IsChecked="{Binding CinemagraphStylusTip, Source={x:Static prop:Settings.Default}, 
                                                        Converter={StaticResource StylusTipToBoolConverter}, ConverterParameter=Ellipse}"/>
                                </Grid>

                                <Label Grid.Row="3" Grid.Column="0" Content="Other:" VerticalAlignment="Center" Padding="0"/>
                                <CheckBox Grid.Row="3" Grid.Column="1" Grid.ColumnSpan="2" x:Name="FitToCurve2CheckBox" Content="Fit To Curve" Margin="5"
                                          IsChecked="{Binding Source={x:Static prop:Settings.Default}, Path=CinemagraphFitToCurve}"/>
                            </Grid>

                            <Label Grid.Row="4" Content="Eraser" Style="{StaticResource LabelSeparator}"
                                   Visibility="{Binding ElementName=EraserMode2RadioButton, Path=IsChecked, Converter={StaticResource Bool2VisibilityConverter}}"/>
                            <Grid Grid.Row="5" Margin="10,0,0,0"
                                  Visibility="{Binding ElementName=EraserMode2RadioButton, Path=IsChecked, Converter={StaticResource Bool2VisibilityConverter}}">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <Label Grid.Row="0" Grid.Column="0" Content="Width:" VerticalAlignment="Center" Padding="0"/>
                                <n:NumericUpDown Grid.Row="0" Grid.Column="1" x:Name="CinemagraphEraserWidthNumericUpDown" Minimum="1" Maximum="100" Margin="10,5" MinWidth="70" 
                                             Value="{Binding Source={x:Static prop:Settings.Default}, Path=CinemagraphEraserWidth}"/>

                                <Label Grid.Row="1" Grid.Column="0" Content="Height:" VerticalAlignment="Center" Padding="0"/>
                                <n:NumericUpDown Grid.Row="1" Grid.Column="1" x:Name="CinemagraphEraserHeightNumericUpDown" Minimum="1" Maximum="100" Margin="10,5" MinWidth="70" 
                                             Value="{Binding Source={x:Static prop:Settings.Default}, Path=CinemagraphEraserHeight}"/>

                                <Label Grid.Row="2" Grid.Column="0" Content="Tip:" VerticalAlignment="Center" Padding="0"/>
                                <Grid Grid.Row="2" Grid.Column="1" Grid.ColumnSpan="2">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition/>
                                        <ColumnDefinition/>
                                    </Grid.ColumnDefinitions>

                                    <n:ImageRadioButton Grid.Row="0" Grid.Column="0" x:Name="RectangleErase2rRadioButton" Content="{StaticResource Vector.Rectangle}" 
                                                        Text="Rectangle" Cursor="Hand" MaxSize="20" Margin="3,3" Padding="0,5"
                                                        IsChecked="{Binding CinemagraphEraserStylusTip, Source={x:Static prop:Settings.Default}, 
                                                        Converter={StaticResource StylusTipToBoolConverter}, ConverterParameter=Rectangle}"/>
                                    <n:ImageRadioButton Grid.Row="0" Grid.Column="1" x:Name="ElipseEraser2RadioButton" Content="{StaticResource Vector.Ellipse}" 
                                                        Text="Elipse" Cursor="Hand" MaxSize="20" Margin="0,3" Padding="0,5"
                                                        IsChecked="{Binding CinemagraphEraserStylusTip, Source={x:Static prop:Settings.Default}, 
                                                        Converter={StaticResource StylusTipToBoolConverter}, ConverterParameter=Ellipse}"/>
                                </Grid>
                            </Grid>

                            <Grid Grid.Row="6">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <n:ImageButton Grid.Column="1" x:Name="ApplyCinemagraphButton" Text="Apply" Padding="10,5" MinWidth="90" MinHeight="20"
                                  Margin="5,5,5,5" Click="ApplyCinemagraphButton_Click" MaxSize="20" Content="{StaticResource Vector.Ok}"/>
                            </Grid>
                        </Grid>
                        <Grid x:Name="OverrideDelayGrid" Visibility="Collapsed">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <Label Grid.Row="0" Content="New Value" Style="{StaticResource LabelSeparator}"/>
                            <Grid Grid.Row="1" Margin="10,0,0,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <Label Grid.Row="0" Grid.Column="0" Content="Delay (ms):" VerticalAlignment="Center" Padding="0"/>
                                <n:NumericUpDown Grid.Row="0" Grid.Column="1" x:Name="NewDelayNumericUpDown" Minimum="10" Maximum="3000" Margin="10,5" MinWidth="80" 
                                                 Value="{Binding Source={x:Static prop:Settings.Default}, Path=PlaybackOverrideDelay}"/>

                                <StackPanel Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2" Orientation="Horizontal">
                                    <Viewbox MinWidth="15" MaxHeight="15" Stretch="Uniform" Child="{StaticResource Vector.Info}" />
                                    <Label Content="Minimum of 10ms per frame" Foreground="#FF289746" FontStyle="Italic" FontSize="11" Padding="3"/>
                                </StackPanel>
                            </Grid>
                            
                            <Grid Grid.Row="2">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <n:ImageButton Grid.Column="1" x:Name="ApplyverrideDelayButton" Text="Apply" Padding="10,5" MinWidth="90" MinHeight="20"
                                               Margin="5,5,5,5" Click="ApplyOverrideDelayButton_Click" MaxSize="20" Content="{StaticResource Vector.Ok}"/>
                            </Grid>
                        </Grid>
                        <Grid x:Name="ChangeDelayGrid" Visibility="Collapsed">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <Label Grid.Row="0" Content="Decrease/Increase Value" Style="{StaticResource LabelSeparator}"/>
                            <Grid Grid.Row="1" Margin="10,0,0,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <Label Grid.Row="0" Grid.Column="0" Content="Delay (ms):" VerticalAlignment="Center" Padding="0"/>
                                <n:NumericUpDown Grid.Row="0" Grid.Column="1" x:Name="ChangeDelayNumericUpDown" Minimum="-3000" Maximum="3000" Margin="10,5" MinWidth="80" 
                                                 Value="{Binding Source={x:Static prop:Settings.Default}, Path=PlaybackChangeDelay}"/>

                                <StackPanel Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2" Orientation="Horizontal">
                                    <Viewbox MinWidth="15" MaxHeight="15" Stretch="Uniform" Child="{StaticResource Vector.Info}" />
                                    <Label Content="Minimum of 10ms per frame" Foreground="#FF289746" FontStyle="Italic" FontSize="11" Padding="3"/>
                                </StackPanel>
                            </Grid>

                            <Grid Grid.Row="2">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <n:ImageButton Grid.Column="1" x:Name="ApplyChangeDelayButton" Text="Apply" Padding="10,5" MinWidth="90" MinHeight="20"
                                               Margin="5,5,5,5" Click="ApplyChangeDelayButton_Click" MaxSize="20" Content="{StaticResource Vector.Ok}"/>
                            </Grid>
                        </Grid>
                    </StackPanel>
                </ScrollViewer>
            </Grid>
        </Grid>

        <!--Lower part of the Window-->
        <ListView x:Name="FrameListView" Grid.Row="2" Style="{DynamicResource FrameListBoxStyle}" BorderThickness="0,1,0,0" Visibility="Collapsed">
            <ListView.Resources>
                <SolidColorBrush x:Key="ListBox.Static.Background" Color="#FFFFFFFF"/>
                <SolidColorBrush x:Key="ListBox.Static.Border" Color="#FFABADB3"/>
                <SolidColorBrush x:Key="ListBox.Disabled.Background" Color="#FFFFFFFF"/>
                <SolidColorBrush x:Key="ListBox.Disabled.Border" Color="#FFD9D9D9"/>

                <Style x:Key="FrameListBoxStyle" TargetType="{x:Type ListView}">
                    <Setter Property="Background" Value="{StaticResource ListBox.Static.Background}"/>
                    <Setter Property="BorderBrush" Value="{StaticResource ListBox.Static.Border}"/>
                    <Setter Property="BorderThickness" Value="1"/>
                    <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"/>
                    <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Auto"/>
                    <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Auto"/>
                    <Setter Property="ScrollViewer.CanContentScroll" Value="true"/>
                    <Setter Property="ScrollViewer.PanningMode" Value="Both"/>
                    <Setter Property="Stylus.IsFlicksEnabled" Value="False"/>
                    <Setter Property="VerticalContentAlignment" Value="Center"/>

                    <Setter Property="ItemsPanel">
                        <Setter.Value>
                            <ItemsPanelTemplate>
                                <StackPanel Orientation="Horizontal" MinHeight="0"/>
                            </ItemsPanelTemplate>
                        </Setter.Value>
                    </Setter>

                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="{x:Type ListView}">
                                <Border x:Name="Bd" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" 
                                        Background="{TemplateBinding Background}" Padding="2" SnapsToDevicePixels="true">
                                    <ScrollViewer Focusable="false" Padding="{TemplateBinding Padding}" CanContentScroll="True">
                                        <ItemsPresenter SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                                    </ScrollViewer>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsEnabled" Value="false">
                                        <Setter Property="Background" TargetName="Bd" Value="{StaticResource ListBox.Disabled.Background}"/>
                                        <Setter Property="BorderBrush" TargetName="Bd" Value="{StaticResource ListBox.Disabled.Border}"/>
                                    </Trigger>
                                    <MultiTrigger>
                                        <MultiTrigger.Conditions>
                                            <Condition Property="IsGrouping" Value="true"/>
                                            <Condition Property="VirtualizingPanel.IsVirtualizingWhenGrouping" Value="false"/>
                                        </MultiTrigger.Conditions>
                                        <Setter Property="ScrollViewer.CanContentScroll" Value="false"/>
                                    </MultiTrigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>

            </ListView.Resources>
        </ListView>

        <Border Grid.Row="3">
            <Grid x:Name="LowerStatusBar" Height="20" Background="#FFF1F1F1">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <Grid x:Name="StatusGrid" Grid.Column="0" Visibility="Hidden">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*" MinWidth="250"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <Label x:Name="StatusLabel" Grid.Column="0" Content="Status" Padding="0" VerticalContentAlignment="Center" Margin="5,0" Foreground="#FF3C3C3C"/>
                    <ProgressBar x:Name="StatusProgressBar" Grid.Column="1" Height="4" Margin="2,0"/>
                    <Separator Grid.Column="2" Width="1" Margin="2"/>
                </Grid>

                <Grid Grid.Column="3" x:Name="InfoGrid" Visibility="{Binding ElementName=WelcomeGrid, Path=IsEnabled, Converter={StaticResource InvertedBoolToVisibilityConverter}}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <Separator Grid.Column="0" Width="1" Margin="3,2"/>

                    <Label Grid.Column="1" Content="{Binding ElementName=FrameListView, Path=SelectedItems.Count}" Padding="0" VerticalContentAlignment="Center" FontSize="12" Foreground="#FF707070"/>
                    <Label Grid.Column="2" Content="/" Padding="0" VerticalContentAlignment="Center" FontSize="12" Foreground="#FF707070"/>
                    <Label Grid.Column="3" Content="{Binding ElementName=FrameListView, Path=SelectedIndex}" Padding="0" VerticalContentAlignment="Center" FontSize="12" Foreground="#FF707070"/>
                </Grid>

                <Separator Grid.Column="4" Width="1" Margin="3,2"/>

                <Grid x:Name="CommandGrid" Grid.Column="5">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <n:ImageButton Grid.Column="0" x:Name="FirstRepeatButton" Content="{StaticResource Vector.First.Green}" MaxSize="22"
                                         Width="40" Text="" Style="{StaticResource Style.Button.NoText}" Command="util:Commands.FirstFrame"/>
                    <n:ImageRepeatButton Grid.Column="1" x:Name="PreviousRepeatButton" Content="{StaticResource Vector.Previous.Green}" MaxSize="18"
                                         Width="40" Text="" Style="{StaticResource Style.RepeatButton.NoText}" Command="util:Commands.PreviousFrame"/>
                    <n:ImageButton Grid.Column="2" x:Name="PlayPauseButton" Content="{StaticResource Vector.Play}" MaxSize="15"
                                         Width="40" Style="{StaticResource Style.Button.NoText}" Command="util:Commands.Play"/>
                    <n:ImageRepeatButton Grid.Column="3" x:Name="NextRepeatButton" Content="{StaticResource Vector.Next.Green}" MaxSize="18"
                                         Width="40" Style="{StaticResource Style.RepeatButton.NoText}" Command="util:Commands.NextFrame"/>
                    <n:ImageButton Grid.Column="4" x:Name="LastRepeatButton" Content="{StaticResource Vector.Last.Green}" MaxSize="22"
                                         Width="40" Style="{StaticResource Style.Button.NoText}" Command="util:Commands.LastFrame"/>
                </Grid>
            </Grid>
        </Border>
    </Grid>
</Window>
